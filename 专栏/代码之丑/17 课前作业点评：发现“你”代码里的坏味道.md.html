<!DOCTYPE html>
<!-- saved from url=(0046)https://kaiiiz.github.io/hexo-theme-book-demo/ -->
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
        <link rel="icon" href="../../static/favicon.png">
        <title>17 课前作业点评：发现“你”代码里的坏味道.md</title>
        <!-- Spectre.css framework -->
        <link rel="stylesheet" href="../../static/index.css">
        <link rel="stylesheet"
              href="../../static/highlight.min.css">
        <script src="../../static/highlight.min.js"></script>
        <!-- theme css & js -->
        <meta name="generator" content="Hexo 4.2.0">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5295275829820252"
                crossorigin="anonymous"></script>
        <script async defer data-website-id="83e5d5db-9d06-40e3-b780-cbae722fdf8c" src="https://analyze.lianglianglee.com/umami.js"></script>
    </head>

<body>

    <div class="book-container">
        <div class="book-sidebar">
            <div class="book-brand">
                <a href="../../index.html">
                    <img src="../../static/favicon.png">
                    <span>技术文章摘抄</span>
                </a>
            </div>
            <div class="book-menu uncollapsible">
                <ul class="uncollapsible">
                    <li><a href="../../index.html" class="current-tab">首页</a></li>
                </ul>

                <ul class="uncollapsible">
                    <li><a href="../index.html">上一级</a></li>
                </ul>

                <ul class="uncollapsible">
                    <li>

                        
                        <a href="00%20%E5%BC%80%E7%AF%87%E8%AF%8D%20%E8%BF%99%E4%B8%80%E6%AC%A1%EF%BC%8C%E6%88%91%E4%BB%AC%E4%BB%8E%E2%80%9C%E4%B8%91%E2%80%9D%E4%BB%A3%E7%A0%81%E5%87%BA%E5%8F%91.md.html">00 开篇词 这一次，我们从“丑”代码出发.md</a>

                    </li>
                    <li>

                        
                        <a href="01%20%E7%BC%BA%E4%B9%8F%E4%B8%9A%E5%8A%A1%E5%90%AB%E4%B9%89%E7%9A%84%E5%91%BD%E5%90%8D%EF%BC%9A%E5%A6%82%E4%BD%95%E7%B2%BE%E5%87%86%E5%91%BD%E5%90%8D%EF%BC%9F.md.html">01 缺乏业务含义的命名：如何精准命名？.md</a>

                    </li>
                    <li>

                        
                        <a href="02%20%E4%B9%B1%E7%94%A8%E8%8B%B1%E8%AF%AD%EF%BC%9A%E7%AB%99%E5%9C%A8%E4%B8%AD%E5%9B%BD%E4%BA%BA%E7%9A%84%E8%A7%86%E8%A7%92%E6%9D%A5%E7%9C%8B%E8%8B%B1%E6%96%87%E5%91%BD%E5%90%8D.md.html">02 乱用英语：站在中国人的视角来看英文命名.md</a>

                    </li>
                    <li>

                        
                        <a href="03%20%E9%87%8D%E5%A4%8D%E4%BB%A3%E7%A0%81%EF%BC%9A%E7%AE%80%E5%8D%95%E9%9C%80%E6%B1%82%E5%88%B0%E5%A4%84%E4%BF%AE%E6%94%B9%EF%BC%8C%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F.md.html">03 重复代码：简单需求到处修改，怎么办？.md</a>

                    </li>
                    <li>

                        
                        <a href="04%20%E9%95%BF%E5%87%BD%E6%95%B0%EF%BC%9A%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%A0%E6%80%BB%E6%98%AF%E4%B8%8D%E5%8F%AF%E9%81%BF%E5%85%8D%E5%9C%B0%E5%86%99%E5%87%BA%E9%95%BF%E5%87%BD%E6%95%B0%EF%BC%9F.md.html">04 长函数：为什么你总是不可避免地写出长函数？.md</a>

                    </li>
                    <li>

                        
                        <a href="05%20%E5%A4%A7%E7%B1%BB%EF%BC%9A%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E5%86%99%E5%87%BA%E9%9A%BE%E4%BB%A5%E7%90%86%E8%A7%A3%E7%9A%84%E5%A4%A7%E7%B1%BB%EF%BC%9F.md.html">05 大类：如何避免写出难以理解的大类？.md</a>

                    </li>
                    <li>

                        
                        <a href="06%20%E9%95%BF%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8%EF%BC%9A%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E7%9A%84%E9%95%BF%E5%8F%82%E6%95%B0%EF%BC%9F.md.html">06 长参数列表：如何处理不同类型的长参数？.md</a>

                    </li>
                    <li>

                        
                        <a href="07%20%E6%BB%A5%E7%94%A8%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5%EF%BC%9A%E5%87%BA%E7%8E%B0%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84%EF%BC%8C%E5%A4%9A%E5%8D%8A%E6%98%AF%E9%94%99%E8%AF%AF%E7%9A%84%E6%8F%90%E7%A4%BA.md.html">07 滥用控制语句：出现控制结构，多半是错误的提示.md</a>

                    </li>
                    <li>

                        
                        <a href="08%20%E7%BC%BA%E4%B9%8F%E5%B0%81%E8%A3%85%EF%BC%9A%E5%A6%82%E4%BD%95%E5%BA%94%E5%AF%B9%E7%81%AB%E8%BD%A6%E4%BB%A3%E7%A0%81%E5%92%8C%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%81%8F%E6%89%A7%E9%97%AE%E9%A2%98%EF%BC%9F.md.html">08 缺乏封装：如何应对火车代码和基本类型偏执问题？.md</a>

                    </li>
                    <li>

                        
                        <a href="09%20%E5%8F%AF%E5%8F%98%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%9A%E4%B8%8D%E8%A6%81%E8%AE%A9%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81%E2%80%9C%E5%A4%B1%E6%8E%A7%E2%80%9D.md.html">09 可变的数据：不要让你的代码“失控”.md</a>

                    </li>
                    <li>

                        
                        <a href="10%20%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%E4%B8%8E%E8%B5%8B%E5%80%BC%E5%88%86%E7%A6%BB%EF%BC%9A%E6%99%AE%E9%80%9A%E7%9A%84%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E%EF%BC%8C%E6%80%8E%E4%B9%88%E4%B9%9F%E6%9C%89%E5%9D%8F%E5%91%B3%E9%81%93%EF%BC%9F.md.html">10 变量声明与赋值分离：普通的变量声明，怎么也有坏味道？.md</a>

                    </li>
                    <li>

                        
                        <a href="11%20%E4%BE%9D%E8%B5%96%E6%B7%B7%E4%B9%B1%EF%BC%9A%E4%BD%A0%E5%8F%AF%E8%83%BD%E8%BF%98%E6%B2%A1%E5%8F%91%E7%8E%B0%E9%97%AE%E9%A2%98%EF%BC%8C%E4%BB%A3%E7%A0%81%E5%B0%B1%E5%B7%B2%E7%BB%8F%E6%97%A0%E6%B3%95%E6%8C%BD%E6%95%91%E4%BA%86.md.html">11 依赖混乱：你可能还没发现问题，代码就已经无法挽救了.md</a>

                    </li>
                    <li>

                        
                        <a href="12%20%E4%B8%8D%E4%B8%80%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%EF%BC%9A%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81%E6%80%BB%E8%A2%AB%E5%90%90%E6%A7%BD%E9%9A%BE%E6%87%82%EF%BC%9F.md.html">12 不一致的代码：为什么你的代码总被吐槽难懂？.md</a>

                    </li>
                    <li>

                        
                        <a href="13%20%E8%90%BD%E5%90%8E%E7%9A%84%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%EF%BC%9A%E4%BD%BF%E7%94%A8%E2%80%9C%E6%96%B0%E2%80%9D%E7%9A%84%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7%E5%92%8C%E7%A8%8B%E5%BA%8F%E5%BA%93%E5%8D%87%E7%BA%A7%E4%BD%A0%E7%9A%84%E4%BB%A3%E7%A0%81.md.html">13 落后的代码风格：使用“新”的语言特性和程序库升级你的代码.md</a>

                    </li>
                    <li>

                        
                        <a href="14%20%E5%A4%9A%E4%B9%85%E8%BF%9B%E8%A1%8C%E4%B8%80%E6%AC%A1%E4%BB%A3%E7%A0%81%E8%AF%84%E5%AE%A1%E6%9C%80%E5%90%88%E9%80%82%EF%BC%9F.md.html">14 多久进行一次代码评审最合适？.md</a>

                    </li>
                    <li>

                        
                        <a href="15%20%E6%96%B0%E9%9C%80%E6%B1%82%E7%A0%B4%E5%9D%8F%E4%BA%86%E4%BB%A3%E7%A0%81%EF%BC%8C%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F.md.html">15 新需求破坏了代码，怎么办？.md</a>

                    </li>
                    <li>

                        
                        <a href="16%20%E7%86%8A%E8%8A%82%EF%BC%9A%E4%BB%80%E4%B9%88%E4%BB%A3%E7%A0%81%E5%BA%94%E8%AF%A5%E8%A2%AB%E9%87%8D%E6%9E%84%EF%BC%9F.md.html">16 熊节：什么代码应该被重构？.md</a>

                    </li>
                    <li>

                        <a class="current-tab" href="17%20%E8%AF%BE%E5%89%8D%E4%BD%9C%E4%B8%9A%E7%82%B9%E8%AF%84%EF%BC%9A%E5%8F%91%E7%8E%B0%E2%80%9C%E4%BD%A0%E2%80%9D%E4%BB%A3%E7%A0%81%E9%87%8C%E7%9A%84%E5%9D%8F%E5%91%B3%E9%81%93.md.html">17 课前作业点评：发现“你”代码里的坏味道.md</a>
                        

                    </li>
                    <li>

                        
                        <a href="%E7%BB%93%E6%9D%9F%E8%AF%AD%20%E5%86%99%E4%BB%A3%E7%A0%81%E6%98%AF%E4%B8%80%E4%BB%B6%E5%8F%AF%E4%BB%A5%E4%B8%80%E7%94%9F%E7%B2%BE%E8%BF%9B%E7%9A%84%E4%BA%8B.md.html">结束语 写代码是一件可以一生精进的事.md</a>

                    </li>
                </ul>

            </div>
        </div>

        <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
            <div class="sidebar-toggle-inner"></div>
        </div>

        <script>
            function add_inner() {
                let inner = document.querySelector('.sidebar-toggle-inner')
                inner.classList.add('show')
            }

            function remove_inner() {
                let inner = document.querySelector('.sidebar-toggle-inner')
                inner.classList.remove('show')
            }

            function sidebar_toggle() {
                let sidebar_toggle = document.querySelector('.sidebar-toggle')
                let sidebar = document.querySelector('.book-sidebar')
                let content = document.querySelector('.off-canvas-content')
                if (sidebar_toggle.classList.contains('extend')) { // show
                    sidebar_toggle.classList.remove('extend')
                    sidebar.classList.remove('hide')
                    content.classList.remove('extend')
                } else { // hide
                    sidebar_toggle.classList.add('extend')
                    sidebar.classList.add('hide')
                    content.classList.add('extend')
                }
            }


            function open_sidebar() {
                let sidebar = document.querySelector('.book-sidebar')
                let overlay = document.querySelector('.off-canvas-overlay')
                sidebar.classList.add('show')
                overlay.classList.add('show')
            }
            function hide_canvas() {
                let sidebar = document.querySelector('.book-sidebar')
                let overlay = document.querySelector('.off-canvas-overlay')
                sidebar.classList.remove('show')
                overlay.classList.remove('show')
            }

        </script>

        <div class="off-canvas-content">
            <div class="columns">
                <div class="column col-12 col-lg-12">
                    <div class="book-navbar">
                        <!-- For Responsive Layout -->
                        <header class="navbar">
                            <section class="navbar-section">
                                <a onclick="open_sidebar()">
                                    <i class="icon icon-menu"></i>
                                </a>
                            </section>
                        </header>
                    </div>
                    <div class="book-content" style="max-width: 960px; margin: 0 auto;
    overflow-x: auto;
    overflow-y: hidden;">
                        <div class="book-post">
                            <p id="tip" align="center"></p>
                            <div><h1>17 课前作业点评：发现“你”代码里的坏味道</h1>
<p>　　你好，我是郑晔。</p>
<p>　　在这个专栏刚开始的时候，我给你留了一个课前作业，实现一个待办事项管理的软件。许多同学都利用自己的业余时间完成了这个作业，感谢大家的付出！</p>
<p>　　学习代码的坏味道，听别人讲是一种方式，但这种方式总会让人有一种隔岸观火的感觉，虽然知道有问题，但感觉并不深刻。最直接受益的方式就是自己写了代码，然后，让别人来点评。其实，这就是某种形式的代码评审。</p>
<p>　　所以，这一讲，我们就来做一次“代码评审”，直接来看看代码中存在的问题。题目背景我就不再做过多的介绍了，如果没有来得及完成作业的同学，可以先到“[课前作业区]”回顾一下题目。</p>
<p>　　既然是指出问题，得罪大家可能就在所难免了，希望你不要介意，毕竟能够发现自己的问题是精进的第一步。好，我们开始！</p>
<h2>从已知的坏味道出发</h2>
<pre><code class="language-java">　　Item itemNew = new Item(item.getName());
　　itemNew.setUserIndex(userIndex);
　　itemNew.setIndex(initUserIndex);
</code></pre>
<p>　　我们的业务需求是添加 TODO 项，这段代码就是在这个过程中创建一个新的 TODO 项对象。那这段代码有什么问题？一方面，这里有 setter，另一方面，这里的 setter 只在初始化的过程中用到。显然，我们可以用一个更完整的构造函数替换掉它。</p>
<p>　　其实，从这段代码出发，我们还能看到一些小问题，比如，这里创建 TODO 项设置了两个字段，一个是 userIndex，一个是 index。index 可以理解，表示这个 TODO 项的索引，但 userIndex 是什么呢？你需要仔细阅读代码才能发现，它其实是一个用户的标识，表示这个索引项是由某个用户创建的。既然是用户标识，按照通常的做法它可以叫 userId，这就降低了理解的难度。</p>
<p>　　这段代码所在类的声明也是一个让人出戏的地方：</p>
<pre><code class="language-java">　　public class ProcessTxtServiceImpl implements ProcessItemservice
</code></pre>
<p>　　这个类实现了一个接口 <strong>ProcessItemservice</strong>，显然，这里的拼写是有问题的，它应该是 ProcessItemService，另外，它的名字叫做“处理（TODO）项的服务”，一方面，在一个服务名字上用了处理这个动词，另一方面，“处理”这个名字也是特别泛化的一个名字。如果是我来声明这个接口，它可能就叫 <strong>ItemService</strong>。</p>
<p>　　所以，你可以看到，仅仅是一个接口的命名，就有这么多的问题。</p>
<p>　　我们再来看这个类的命名 <strong>ProcessTxtServiceImpl</strong>，这个名字里有一个 Txt 是容易让人困惑的，一般来说，如果不是特别的原因，<strong>尽量不要用缩写</strong>。</p>
<p>　　我初看到这个名字时，着实想了半天它表示什么含义，一开始我以为是表示事务（Transaction），常有人把事务缩写成 Tx，如果它的含义是表示事务，那么这里就是一个拼写错误了。后来，我才想明白，这里的 Txt 表示的是文本（Text），<strong>仅仅省了一个字母，却造成了理解上更大的障碍，实在有些得不偿失。</strong></p>
<p>　　如果 Txt 表示的是文本，这里就暴露出另外一个问题。这里为什么要有一个文本呢？其实是对应着另外一个数据库存储的实现，这是第四阶段的要求。</p>
<p>　　文本和数据库的差别到底是体现在哪里呢？体现在存储上。而在这段代码中，差别从服务层面就开始了，换言之，按照这段代码的逻辑，实现数据库存储，就需要把整个的业务逻辑重新写一遍。显然，这种做法是从结构上来看是有问题的，会造成大量的重复代码。</p>
<p>　　理解了文本和数据库只差别在存储这件事，我们再回过头来看这个类的声明。</p>
<pre><code class="language-java">　　public class ProcessTxtServiceImpl implements ProcessItemservice
</code></pre>
<p>　　这个为数据库预留的实现根本就是不需要的，只有一个 ItemService 的实现就够了，换言之，也就没有必要声明出一个接口，这里的类层次这么复杂，根本就是没有必要的。</p>
<p>　　这里我再补充一个点，很多 Java 程序员给类命名有个不好的习惯，用“I” 打头给接口命名，用“Impl”给实现类结尾，这其实是早期的一种编程习惯，准确地说，这就是没有想好命名的偷懒方式。其实，它也是我们讲到的“[用技术术语命名]”的一种具体体现方式。后来的代码基本上就不这么做了，因为我们可以找到更准确的描述。但很多人的编程习惯却留在了早期，所以，这也算是一种遗毒的吧。</p>
<h2>一个“静态”的问题</h2>
<p>　　接下来，我们再来看一个很多人代码中都存在的问题。</p>
<p>　　下面是来自<a href="https://github.com/liudaming/todo">刘大明</a>同学的<a href="https://github.com/liudaming/todo/blob/main/src/main/java/com/timegeekbang/todo/user/UserContext.java">一段代码</a>，这是一个用以存放用户信息的类。单看这段代码本身，其实写得还是非常不错的，代码本身并不长，而且考虑了很多的细节。我们暂且忽略其它的细节，我注意到这段代码的主要原因是因为它用到了 static：</p>
<pre><code class="language-java">　　public class UserContext {

　　  private static ThreadLocal&lt;Integer&gt; USERID = new ThreadLocal();

　　  private UserContext() {
　　    throw new UnsupportedOperationException();
　　  }

　　  public static String getUserID() {
　　    return String.valueOf(USERID.get());
　　  }

　　  public static void setUserID(Integer userID) {
　　    USERID.set(userID);
　　  }

　　}
</code></pre>
<p>　　在《10x 程序员工作法》讲到[测试驱动开发]时，我曾经讲了 static 函数的问题，简单总结一下就是：</p>
<p>　　从本质上说，static 函数是一种全局函数，static 变量是一种全局变量，全局的函数和变量是我们尽量规避的；</p>
<p>　　一个函数调用了 static 函数不好测试；</p>
<p>　　除了写程序库，日常开发尽可能不用 static 函数。</p>
<p>　　那怎么消除 static 函数呢？消除 static 函数，最简单的做法就是用普通的函数调用替换掉 static 函数，也就是把这里的 static 都去掉。涉及到相应的字段，也要去掉 static。这种做法没有问题，但通常这种做法太粗暴了。这里我们尝试着用重构的方式一步一步地把它替换掉。</p>
<p>　　首先，我要去掉这里的构造函数，因为这里的构造函数是私有的，无法调用，而我们要用普通的函数，自然就需要构造出一个对象来。</p>
<pre><code class="language-java">　　public class UserContext {

　　  private static ThreadLocal&lt;Integer&gt; USERID = new ThreadLocal();

　　  public static String getUserID() {
　　    return String.valueOf(USERID.get());
　　  }

　　  public static void setUserID(Integer userID) {
　　    USERID.set(userID);
　　  }

　　}
</code></pre>
<p>　　然后，我们需要找到对应的调用点，这里就以其中的一个为例，下面就是在退出登录的地方调用了这里的 static 函数：</p>
<pre><code class="language-java">　　public class UserAccounts {

　　  ...

　　  public void loginOut() {
　　    UserContext.setUserID(null);
　　  }

　　}
</code></pre>
<p>　　我们可以把它改成对象的调用：</p>
<pre><code class="language-java">　　public class UserAccounts {

　　  ...

　　  public void loginOut() {
　　    new UserContext().setUserID(null);
　　  }

　　}
</code></pre>
<p>　　这样，我们就有了一个对象，因为原来的函数是 static 函数，所以，这里的调用，本质上还是原来的函数，所以不会有影响。</p>
<p>　　然后，我们把这个创建出的对象变成这个类的字段，如果你使用的是支持重构功能的 IDE，这就是一个快捷键的操作（引入字段，Introduce Field）：</p>
<pre><code class="language-java">　　public class UserAccounts {

　　  ...

　　  private UserContext context = new UserContext();

　　  public void loginOut() {
　　    context.setUserID(null);
　　  }

　　}
</code></pre>
<p>　　如果在一个类有多个调用点，不妨都改成这个新字段的函数调用，正如我们前面所说，目前还是一个 static 函数，无论从哪个对象调用，调用的都是同一个函数。</p>
<p>　　通常来说，这个 static 函数应该不只是在一个类中使用，所以，它应该是在多个类中间共享的，为了保证多个类中间使用同一个 UserContext 对象，UserContext 对象的初始化就不能在这个类进行，而要在同一个地方初始化，所以，我们这里可以把 UserContext 对象作为构造函数的参数传进来：</p>
<pre><code class="language-java">　　public class UserAccounts {

　　  ...

　　  private UserContext context;

　　  public UserAccounts(..., final UserContext context) {

　　    ...

　　    this.context = context;

　　  }

　　  public void loginOut() {
　　    context.setUserID(null);
　　  }

　　}
</code></pre>
<p>　　有了这个基础，我们再在 UserAccounts 这个对象初始化的时候，把这个 UserContext 对象传进来：</p>
<pre><code class="language-java">　　new UserAccounts(..., new UserContext());
</code></pre>
<p>　　如此一来，UserContext 这个对象的初始化就放到对象组装的过程中了，这就可以在多个不同的对象组件中共享这个对象了。如此往复，将所有的调用点都这么修改，我们就消除了对于 static 函数的依赖。现在，我们可以动手消除 static 了：</p>
<pre><code class="language-java">　　public class UserContext {

　　  private ThreadLocal&lt;Integer&gt; USERID = new ThreadLocal();

　　  public String getUserID() {
　　    return String.valueOf(USERID.get());
　　  }

　　  public void setUserID(Integer userID) {
　　    USERID.set(userID);
　　  }

　　}
</code></pre>
<p>　　消除 static 函数本身并不难，这里我是借着这个简单的例子，给你演示一下，如何一步一步地进行重构。可能这比很多人以为的大刀阔斧地修改代码来得要琐碎得多，<strong>但只有这样一点一点调整，代码足够安全，每一步都是能够停下来的。</strong></p>
<p>　　无论如何，请别忘了，真正能给予我们修改有效性回答的是，<strong>单元测试</strong>。</p>
<p>　　估计很多人看到这里就会说，如果 static 都成了坏味道，那 Singleton 模式该怎么办呢？答案就是<strong>尽可能不用 Singleton 模式</strong>。我在《软件设计之美》中讲[可测试性]和[设计模式]时，都说到过 Singleton 模式，简单地说，系统里只有一个实例和限制系统里只能构建出一个实例，这是两件事，而且，如果一个函数牵扯到 Singleton 类也不好测试。</p>
<p>　　在一些同学的代码中，我也看到的 Singleton 模式的使用，处理手法其实与这里消除 static 函数是类似的，只不过，Singleton 稍微好一点的是，它的函数和字段本身都已经是普通的类成员了，我们只需要把那个限制实例唯一的 static 函数和字段消除就可以了。</p>
<p>　　说了半天的代码问题，我还想对很多人普遍忽略的小问题说上几句，这就是文档，对应到各位的代码库中，主要就是 README。</p>
<p>　　一个开源项目的好坏与否，同它的文档质量是强相关的。我知道，作为程序员，大家的普遍兴趣都是写代码，所以，文档就常常被忽略了。</p>
<p>　　如果我不了解这个项目的背景，很多人的 README 给我提供的信息量是非常有限的。</p>
<p>　　大家的 README 普遍存在的问题有两种，一种是信息量太少，比如，只写了如何构建一个项目，另一种是把 README 当成 blog，在里面写了自己的心得体会。无论是哪种，信息的有效性都很差。</p>
<p>　　README 文件是一个项目的门面，它应该给我们提供关于这个项目的背景信息，比如，这个项目是做什么的、当前的状态、如何入手等等。你可以找一些经典的开源项目，去看看好的 README 是怎么写的。<strong>好的程序员要学会表达，不仅仅会用代码表达，也要会用文字表达</strong>。</p>
<p>　　好，这就是大家作业中的所有问题了吗？当然不是，代码中存在的问题还很多。不过，你不用担心，即便这个专栏的正式更新结束了，我也会考虑以加餐的形式，继续我们这个云端的代码评审环节。所以，之前没来得及写代码的同学依然可以继续写，说不定下次就会谈到你的代码。</p>
<h2>总结时刻</h2>
<p>　　今天我们点评了大家代码中存在的一些问题，除了之前在专栏中讲到过的坏味道，今天我们还讲到了一些一眼就可以看出问题的坏味道：</p>
<p>　　使用缩写；</p>
<p>　　用 I 表示接口，用 Impl 表示实现；</p>
<p>　　使用 static 函数或变量；</p>
<p>　　使用 singleton 模式；</p>
<p>　　写得潦草的 README。</p>
<p>　　你在写代码时也要注意这些问题。</p>
<p>　　我还借着 static 函数的调整过程，给你演示了如何一步一步地重构代码，保证代码的安全。希望你能够理解，重构不是大开大合的过程，而就是这样细小而微的操作。</p>
<p>　　如果今天的内容你只能记住一件事，那请记住：<strong>尽量不使用 static</strong>。</p>
<p>　　<img src="assets/802cfa950b97bc944e0619afef945830-20220725221729-l4xn1co.jpg" alt="" /></p>
<h2>思考题</h2>
<p>　　我们今天谈到了文档，你平时写文档吗？或者，你平时阅读项目文档，发现什么值得改善的地方吗？欢迎在留言区分享你的经验。</p>
</div>
                        </div>
                        <div>
                            <div style="float: left">
                                <a href="16%20%E7%86%8A%E8%8A%82%EF%BC%9A%E4%BB%80%E4%B9%88%E4%BB%A3%E7%A0%81%E5%BA%94%E8%AF%A5%E8%A2%AB%E9%87%8D%E6%9E%84%EF%BC%9F.md.html">上一页</a>
                            </div>
                            <div style="float: right">
                                <a href="%E7%BB%93%E6%9D%9F%E8%AF%AD%20%E5%86%99%E4%BB%A3%E7%A0%81%E6%98%AF%E4%B8%80%E4%BB%B6%E5%8F%AF%E4%BB%A5%E4%B8%80%E7%94%9F%E7%B2%BE%E8%BF%9B%E7%9A%84%E4%BA%8B.md.html">下一页</a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="copyright"><p>© 2019 - 2023 <a href="../../cdn-cgi/l/email-protection.html#9ef2f2f2a7aaafafaea9def9f3fff7f2b0fdf1f3" target="_blank">Liangliang Lee</a>. Powered by <a href="https://vertx.io/" target="_blank">Vert.x</a> and <a href="https://github.com/kaiiiz/hexo-theme-book" target="_blank">hexo-theme-book</a>.</p></div>
        </div>

        <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
    </div>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vb26e4fa9e5134444860be286fd8771851679335129114" integrity="sha512-M3hN/6cva/SjwrOtyXeUa5IuCT0sedyfT+jK/OV+s+D0RnzrTfwjwJHhd+wYfMm9HJSrZ1IKksOdddLuN6KOzw==" data-cf-beacon='{"rayId":"7af0cf83df0bd025","version":"2023.3.0","r":1,"token":"1f5d475227ce4f0089a7cff1ab17c0f5","si":100}' crossorigin="anonymous"></script>
</body>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NPSEEVD756"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-NPSEEVD756');
    var path = window.location.pathname
    var cookie = getCookie("lastPath");
    console.log(path)
    if (path.replace("/", "") === "") {
        if (cookie.replace("/", "") !== "") {
            console.log(cookie)
            document.getElementById("tip").innerHTML = "<a href='" + cookie + "'>跳转到上次进度</a>"
        }
    } else {
        setCookie("lastPath", path)
    }

    function setCookie(cname, cvalue) {
        var d = new Date();
        d.setTime(d.getTime() + (180 * 24 * 60 * 60 * 1000));
        var expires = "expires=" + d.toGMTString();
        document.cookie = cname + "=" + cvalue + "; " + expires + ";path = /";
    }

    function getCookie(cname) {
        var name = cname + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i].trim();
            if (c.indexOf(name) === 0) return c.substring(name.length, c.length);
        }
        return "";
    }

    hljs.initHighlightingOnLoad()

</script>

</html>
