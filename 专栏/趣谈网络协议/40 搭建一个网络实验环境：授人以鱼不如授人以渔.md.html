<!DOCTYPE html>
<!-- saved from url=(0046)https://kaiiiz.github.io/hexo-theme-book-demo/ -->
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
        <link rel="icon" href="../../static/favicon.png">
        <title>40 搭建一个网络实验环境：授人以鱼不如授人以渔.md</title>
        <!-- Spectre.css framework -->
        <link rel="stylesheet" href="../../static/index.css">
        <link rel="stylesheet"
              href="../../static/highlight.min.css">
        <script src="../../static/highlight.min.js"></script>
        <!-- theme css & js -->
        <meta name="generator" content="Hexo 4.2.0">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5295275829820252"
                crossorigin="anonymous"></script>
        <script async defer data-website-id="83e5d5db-9d06-40e3-b780-cbae722fdf8c" src="https://analyze.lianglianglee.com/umami.js"></script>
    </head>

<body>

    <div class="book-container">
        <div class="book-sidebar">
            <div class="book-brand">
                <a href="../../index.html">
                    <img src="../../static/favicon.png">
                    <span>技术文章摘抄</span>
                </a>
            </div>
            <div class="book-menu uncollapsible">
                <ul class="uncollapsible">
                    <li><a href="../../index.html" class="current-tab">首页</a></li>
                </ul>

                <ul class="uncollapsible">
                    <li><a href="../index.html">上一级</a></li>
                </ul>

                <ul class="uncollapsible">
                    <li>

                        
                        <a href="00%20%E5%BC%80%E7%AF%87%E8%AF%8D%20%E6%83%B3%E6%88%90%E4%B8%BA%E6%8A%80%E6%9C%AF%E7%89%9B%E4%BA%BA%EF%BC%9F%E5%85%88%E6%90%9E%E5%AE%9A%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%EF%BC%81.md.html">00 开篇词 想成为技术牛人？先搞定网络协议！.md</a>

                    </li>
                    <li>

                        
                        <a href="01%20%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%AD%A6%E4%B9%A0%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%EF%BC%9F.md.html">01 为什么要学习网络协议？.md</a>

                    </li>
                    <li>

                        
                        <a href="02%20%E7%BD%91%E7%BB%9C%E5%88%86%E5%B1%82%E7%9A%84%E7%9C%9F%E5%AE%9E%E5%90%AB%E4%B9%89%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F.md.html">02 网络分层的真实含义是什么？.md</a>

                    </li>
                    <li>

                        
                        <a href="03%20ifconfig%EF%BC%9A%E6%9C%80%E7%86%9F%E6%82%89%E5%8F%88%E9%99%8C%E7%94%9F%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C.md.html">03 ifconfig：最熟悉又陌生的命令行.md</a>

                    </li>
                    <li>

                        
                        <a href="04%20DHCP%E4%B8%8EPXE%EF%BC%9AIP%E6%98%AF%E6%80%8E%E4%B9%88%E6%9D%A5%E7%9A%84%EF%BC%8C%E5%8F%88%E6%98%AF%E6%80%8E%E4%B9%88%E6%B2%A1%E7%9A%84%EF%BC%9F.md.html">04 DHCP与PXE：IP是怎么来的，又是怎么没的？.md</a>

                    </li>
                    <li>

                        
                        <a href="05%20%E4%BB%8E%E7%89%A9%E7%90%86%E5%B1%82%E5%88%B0MAC%E5%B1%82%EF%BC%9A%E5%A6%82%E4%BD%95%E5%9C%A8%E5%AE%BF%E8%88%8D%E9%87%8C%E8%87%AA%E5%B7%B1%E7%BB%84%E7%BD%91%E7%8E%A9%E8%81%94%E6%9C%BA%E6%B8%B8%E6%88%8F%EF%BC%9F.md.html">05 从物理层到MAC层：如何在宿舍里自己组网玩联机游戏？.md</a>

                    </li>
                    <li>

                        
                        <a href="06%20%E4%BA%A4%E6%8D%A2%E6%9C%BA%E4%B8%8EVLAN%EF%BC%9A%E5%8A%9E%E5%85%AC%E5%AE%A4%E5%A4%AA%E5%A4%8D%E6%9D%82%EF%BC%8C%E6%88%91%E8%A6%81%E5%9B%9E%E5%AD%A6%E6%A0%A1.md.html">06 交换机与VLAN：办公室太复杂，我要回学校.md</a>

                    </li>
                    <li>

                        
                        <a href="07%20ICMP%E4%B8%8Eping%EF%BC%9A%E6%8A%95%E7%9F%B3%E9%97%AE%E8%B7%AF%E7%9A%84%E4%BE%A6%E5%AF%9F%E5%85%B5.md.html">07 ICMP与ping：投石问路的侦察兵.md</a>

                    </li>
                    <li>

                        
                        <a href="08%20%E4%B8%96%E7%95%8C%E8%BF%99%E4%B9%88%E5%A4%A7%EF%BC%8C%E6%88%91%E6%83%B3%E5%87%BA%E7%BD%91%E5%85%B3%EF%BC%9A%E6%AC%A7%E6%B4%B2%E5%8D%81%E5%9B%BD%E6%B8%B8%E4%B8%8E%E7%8E%84%E5%A5%98%E8%A5%BF%E8%A1%8C.md.html">08 世界这么大，我想出网关：欧洲十国游与玄奘西行.md</a>

                    </li>
                    <li>

                        
                        <a href="09%20%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%EF%BC%9A%E8%A5%BF%E5%87%BA%E7%BD%91%E5%85%B3%E6%97%A0%E6%95%85%E4%BA%BA%EF%BC%8C%E6%95%A2%E9%97%AE%E8%B7%AF%E5%9C%A8%E4%BD%95%E6%96%B9.md.html">09 路由协议：西出网关无故人，敢问路在何方.md</a>

                    </li>
                    <li>

                        
                        <a href="10%20UDP%E5%8D%8F%E8%AE%AE%EF%BC%9A%E5%9B%A0%E6%80%A7%E5%96%84%E8%80%8C%E7%AE%80%E5%8D%95%EF%BC%8C%E9%9A%BE%E5%85%8D%E7%A2%B0%E5%88%B0%E2%80%9C%E5%9F%8E%E4%BC%9A%E7%8E%A9%E2%80%9D.md.html">10 UDP协议：因性善而简单，难免碰到“城会玩”.md</a>

                    </li>
                    <li>

                        
                        <a href="11%20TCP%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E5%9B%A0%E6%80%A7%E6%81%B6%E8%80%8C%E5%A4%8D%E6%9D%82%EF%BC%8C%E5%85%88%E6%81%B6%E5%90%8E%E5%96%84%E5%8F%8D%E8%BD%BB%E6%9D%BE.md.html">11 TCP协议（上）：因性恶而复杂，先恶后善反轻松.md</a>

                    </li>
                    <li>

                        
                        <a href="12%20TCP%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E8%A5%BF%E8%A1%8C%E5%BF%85%E5%AE%9A%E5%A4%9A%E5%A6%96%E5%AD%BD%EF%BC%8C%E6%81%92%E5%BF%83%E6%99%BA%E6%85%A7%E6%B6%88%E7%A3%A8%E9%9A%BE.md.html">12 TCP协议（下）：西行必定多妖孽，恒心智慧消磨难.md</a>

                    </li>
                    <li>

                        
                        <a href="13%20%E5%A5%97%E6%8E%A5%E5%AD%97Socket%EF%BC%9ATalk%20is%20cheap,%20show%20me%20the%20code.md.html">13 套接字Socket：Talk is cheap, show me the code.md</a>

                    </li>
                    <li>

                        
                        <a href="14%20HTTP%E5%8D%8F%E8%AE%AE%EF%BC%9A%E7%9C%8B%E4%B8%AA%E6%96%B0%E9%97%BB%E5%8E%9F%E6%9D%A5%E8%BF%99%E4%B9%88%E9%BA%BB%E7%83%A6.md.html">14 HTTP协议：看个新闻原来这么麻烦.md</a>

                    </li>
                    <li>

                        
                        <a href="15%20HTTPS%E5%8D%8F%E8%AE%AE%EF%BC%9A%E7%82%B9%E5%A4%96%E5%8D%96%E7%9A%84%E8%BF%87%E7%A8%8B%E5%8E%9F%E6%9D%A5%E8%BF%99%E4%B9%88%E5%A4%8D%E6%9D%82.md.html">15 HTTPS协议：点外卖的过程原来这么复杂.md</a>

                    </li>
                    <li>

                        
                        <a href="16%20%E6%B5%81%E5%AA%92%E4%BD%93%E5%8D%8F%E8%AE%AE%EF%BC%9A%E5%A6%82%E4%BD%95%E5%9C%A8%E7%9B%B4%E6%92%AD%E9%87%8C%E7%9C%8B%E5%88%B0%E7%BE%8E%E5%A5%B3%E5%B8%85%E5%93%A5%EF%BC%9F.md.html">16 流媒体协议：如何在直播里看到美女帅哥？.md</a>

                    </li>
                    <li>

                        
                        <a href="17%20P2P%E5%8D%8F%E8%AE%AE%EF%BC%9A%E6%88%91%E4%B8%8B%E5%B0%8F%E7%94%B5%E5%BD%B1%EF%BC%8C99%EF%B9%AA%E6%80%A5%E6%AD%BB%E4%BD%A0.md.html">17 P2P协议：我下小电影，99%急死你.md</a>

                    </li>
                    <li>

                        
                        <a href="18%20DNS%E5%8D%8F%E8%AE%AE%EF%BC%9A%E7%BD%91%E7%BB%9C%E4%B8%96%E7%95%8C%E7%9A%84%E5%9C%B0%E5%9D%80%E7%B0%BF.md.html">18 DNS协议：网络世界的地址簿.md</a>

                    </li>
                    <li>

                        
                        <a href="19%20HttpDNS%EF%BC%9A%E7%BD%91%E7%BB%9C%E4%B8%96%E7%95%8C%E7%9A%84%E5%9C%B0%E5%9D%80%E7%B0%BF%E4%B9%9F%E4%BC%9A%E6%8C%87%E9%94%99%E8%B7%AF.md.html">19 HttpDNS：网络世界的地址簿也会指错路.md</a>

                    </li>
                    <li>

                        
                        <a href="20%20CDN%EF%BC%9A%E4%BD%A0%E5%8E%BB%E5%B0%8F%E5%8D%96%E9%83%A8%E5%8F%96%E8%BF%87%E5%BF%AB%E9%80%92%E4%B9%88%EF%BC%9F.md.html">20 CDN：你去小卖部取过快递么？.md</a>

                    </li>
                    <li>

                        
                        <a href="21%20%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%BF%83%EF%BC%9A%E6%88%91%E6%98%AF%E5%BC%80%E5%8F%91%E5%95%86%EF%BC%8C%E8%87%AA%E5%B7%B1%E6%8B%BF%E5%9C%B0%E7%9B%96%E5%88%AB%E5%A2%85.md.html">21 数据中心：我是开发商，自己拿地盖别墅.md</a>

                    </li>
                    <li>

                        
                        <a href="22%20VPN%EF%BC%9A%E6%9C%9D%E4%B8%AD%E6%9C%89%E4%BA%BA%E5%A5%BD%E5%81%9A%E5%AE%98.md.html">22 VPN：朝中有人好做官.md</a>

                    </li>
                    <li>

                        
                        <a href="23%20%E7%A7%BB%E5%8A%A8%E7%BD%91%E7%BB%9C%EF%BC%9A%E5%8E%BB%E5%B7%B4%E5%A1%9E%E7%BD%97%E9%82%A3%EF%BC%8C%E6%89%8B%E6%9C%BA%E4%B9%9F%E4%B8%8A%E4%B8%8D%E4%BA%86%E8%84%B8%E4%B9%A6.md.html">23 移动网络：去巴塞罗那，手机也上不了脸书.md</a>

                    </li>
                    <li>

                        
                        <a href="24%20%E4%BA%91%E4%B8%AD%E7%BD%91%E7%BB%9C%EF%BC%9A%E8%87%AA%E5%B7%B1%E6%8B%BF%E5%9C%B0%E6%88%90%E6%9C%AC%E9%AB%98%EF%BC%8C%E8%B4%AD%E4%B9%B0%E5%85%AC%E5%AF%93%E6%9B%B4%E7%81%B5%E6%B4%BB.md.html">24 云中网络：自己拿地成本高，购买公寓更灵活.md</a>

                    </li>
                    <li>

                        
                        <a href="25%20%E8%BD%AF%E4%BB%B6%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C%EF%BC%9A%E5%85%B1%E4%BA%AB%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E7%9A%84%E5%B0%8F%E5%8C%BA%E7%89%A9%E4%B8%9A%E7%AE%A1%E7%90%86%E5%8A%9E%E6%B3%95.md.html">25 软件定义网络：共享基础设施的小区物业管理办法.md</a>

                    </li>
                    <li>

                        
                        <a href="26%20%E4%BA%91%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%EF%BC%9A%E8%99%BD%E7%84%B6%E4%B8%8D%E6%98%AF%E5%9C%9F%E8%B1%AA%EF%BC%8C%E4%B9%9F%E9%9C%80%E8%A6%81%E5%9F%BA%E6%9C%AC%E5%AE%89%E5%85%A8%E5%92%8C%E4%BF%9D%E9%9A%9C.md.html">26 云中的网络安全：虽然不是土豪，也需要基本安全和保障.md</a>

                    </li>
                    <li>

                        
                        <a href="27%20%E4%BA%91%E4%B8%AD%E7%9A%84%E7%BD%91%E7%BB%9CQoS%EF%BC%9A%E9%82%BB%E5%B1%85%E7%96%AF%E7%8B%82%E4%B8%8B%E7%94%B5%E5%BD%B1%EF%BC%8C%E6%88%91%E8%AF%A5%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F.md.html">27 云中的网络QoS：邻居疯狂下电影，我该怎么办？.md</a>

                    </li>
                    <li>

                        
                        <a href="28%20%E4%BA%91%E4%B8%AD%E7%BD%91%E7%BB%9C%E7%9A%84%E9%9A%94%E7%A6%BBGRE%E3%80%81VXLAN%EF%BC%9A%E8%99%BD%E7%84%B6%E4%BD%8F%E4%B8%80%E4%B8%AA%E5%B0%8F%E5%8C%BA%EF%BC%8C%E4%B9%9F%E8%A6%81%E4%BF%9D%E6%8A%A4%E9%9A%90%E7%A7%81.md.html">28 云中网络的隔离GRE、VXLAN：虽然住一个小区，也要保护隐私.md</a>

                    </li>
                    <li>

                        
                        <a href="29%20%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%EF%BC%9A%E6%9D%A5%E5%8E%BB%E8%87%AA%E7%94%B1%E7%9A%84%E6%97%A5%E5%AD%90%EF%BC%8C%E4%B8%8D%E4%B9%B0%E5%85%AC%E5%AF%93%E5%8E%BB%E5%90%88%E7%A7%9F.md.html">29 容器网络：来去自由的日子，不买公寓去合租.md</a>

                    </li>
                    <li>

                        
                        <a href="30%20%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E4%B9%8BFlannel%EF%BC%9A%E6%AF%8F%E4%BA%BA%E4%B8%80%E4%BA%A9%E4%B8%89%E5%88%86%E5%9C%B0.md.html">30 容器网络之Flannel：每人一亩三分地.md</a>

                    </li>
                    <li>

                        
                        <a href="31%20%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E4%B9%8BCalico%EF%BC%9A%E4%B8%BA%E9%AB%98%E6%95%88%E8%AF%B4%E5%87%BA%E5%96%84%E6%84%8F%E7%9A%84%E8%B0%8E%E8%A8%80.md.html">31 容器网络之Calico：为高效说出善意的谎言.md</a>

                    </li>
                    <li>

                        
                        <a href="32%20RPC%E5%8D%8F%E8%AE%AE%E7%BB%BC%E8%BF%B0%EF%BC%9A%E8%BF%9C%E5%9C%A8%E5%A4%A9%E8%BE%B9%EF%BC%8C%E8%BF%91%E5%9C%A8%E7%9C%BC%E5%89%8D.md.html">32 RPC协议综述：远在天边，近在眼前.md</a>

                    </li>
                    <li>

                        
                        <a href="33%20%E5%9F%BA%E4%BA%8EXML%E7%9A%84SOAP%E5%8D%8F%E8%AE%AE%EF%BC%9A%E4%B8%8D%E8%A6%81%E8%AF%B4NBA%EF%BC%8C%E8%AF%B7%E8%AF%B4%E7%BE%8E%E5%9B%BD%E8%81%8C%E4%B8%9A%E7%AF%AE%E7%90%83%E8%81%94%E8%B5%9B.md.html">33 基于XML的SOAP协议：不要说NBA，请说美国职业篮球联赛.md</a>

                    </li>
                    <li>

                        
                        <a href="34%20%E5%9F%BA%E4%BA%8EJSON%E7%9A%84RESTful%E6%8E%A5%E5%8F%A3%E5%8D%8F%E8%AE%AE%EF%BC%9A%E6%88%91%E4%B8%8D%E5%85%B3%E5%BF%83%E8%BF%87%E7%A8%8B%EF%BC%8C%E8%AF%B7%E7%BB%99%E6%88%91%E7%BB%93%E6%9E%9C.md.html">34 基于JSON的RESTful接口协议：我不关心过程，请给我结果.md</a>

                    </li>
                    <li>

                        
                        <a href="35%20%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%B1%BBRPC%E5%8D%8F%E8%AE%AE%EF%BC%9A%E8%BF%98%E6%98%AF%E5%8F%ABNBA%E5%90%A7%EF%BC%8C%E6%80%BB%E8%AF%B4%E5%85%A8%E7%A7%B0%E5%A4%9A%E8%B4%B9%E5%8A%B2.md.html">35 二进制类RPC协议：还是叫NBA吧，总说全称多费劲.md</a>

                    </li>
                    <li>

                        
                        <a href="36%20%E8%B7%A8%E8%AF%AD%E8%A8%80%E7%B1%BBRPC%E5%8D%8F%E8%AE%AE%EF%BC%9A%E4%BA%A4%E6%B5%81%E4%B9%8B%E5%89%8D%EF%BC%8C%E5%8F%8C%E6%96%B9%E5%85%88%E6%9D%A5%E4%B8%AA%E4%B8%93%E4%B8%9A%E6%9C%AF%E8%AF%AD%E8%A1%A8.md.html">36 跨语言类RPC协议：交流之前，双方先来个专业术语表.md</a>

                    </li>
                    <li>

                        
                        <a href="37%20%E7%9F%A5%E8%AF%86%E4%B8%B2%EF%BC%9A%E7%94%A8%E5%8F%8C%E5%8D%81%E4%B8%80%E7%9A%84%E6%95%85%E4%BA%8B%E4%B8%B2%E8%B5%B7%E7%A2%8E%E7%89%87%E7%9A%84%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%B8%8A%EF%BC%89.md.html">37 知识串：用双十一的故事串起碎片的网络协议（上）.md</a>

                    </li>
                    <li>

                        
                        <a href="38%20%E7%9F%A5%E8%AF%86%E4%B8%B2%EF%BC%9A%E7%94%A8%E5%8F%8C%E5%8D%81%E4%B8%80%E7%9A%84%E6%95%85%E4%BA%8B%E4%B8%B2%E8%B5%B7%E7%A2%8E%E7%89%87%E7%9A%84%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%B8%AD%EF%BC%89.md.html">38 知识串：用双十一的故事串起碎片的网络协议（中）.md</a>

                    </li>
                    <li>

                        
                        <a href="39%20%E7%9F%A5%E8%AF%86%E4%B8%B2%EF%BC%9A%E7%94%A8%E5%8F%8C%E5%8D%81%E4%B8%80%E7%9A%84%E6%95%85%E4%BA%8B%E4%B8%B2%E8%B5%B7%E7%A2%8E%E7%89%87%E7%9A%84%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%B8%8B%EF%BC%89.md.html">39 知识串：用双十一的故事串起碎片的网络协议（下）.md</a>

                    </li>
                    <li>

                        <a class="current-tab" href="40%20%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%BD%91%E7%BB%9C%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%EF%BC%9A%E6%8E%88%E4%BA%BA%E4%BB%A5%E9%B1%BC%E4%B8%8D%E5%A6%82%E6%8E%88%E4%BA%BA%E4%BB%A5%E6%B8%94.md.html">40 搭建一个网络实验环境：授人以鱼不如授人以渔.md</a>
                        

                    </li>
                    <li>

                        
                        <a href="%E5%8A%A0%E9%A4%901%20%E5%88%9B%E4%BD%9C%E6%95%85%E4%BA%8B%EF%BC%9A%E6%88%91%E6%98%AF%E5%A6%82%E4%BD%95%E5%88%9B%E4%BD%9C%E2%80%9C%E8%B6%A3%E8%B0%88%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E2%80%9D%E4%B8%93%E6%A0%8F%E7%9A%84%EF%BC%9F.md.html">加餐1 创作故事：我是如何创作“趣谈网络协议”专栏的？.md</a>

                    </li>
                    <li>

                        
                        <a href="%E5%8D%8F%E8%AE%AE%E4%B8%93%E6%A0%8F%E7%89%B9%E5%88%AB%E7%A6%8F%E5%88%A9%20%E7%AD%94%E7%96%91%E8%A7%A3%E6%83%911%E6%9C%9F.md.html">协议专栏特别福利 答疑解惑1期.md</a>

                    </li>
                    <li>

                        
                        <a href="%E5%8D%8F%E8%AE%AE%E4%B8%93%E6%A0%8F%E7%89%B9%E5%88%AB%E7%A6%8F%E5%88%A9%20%E7%AD%94%E7%96%91%E8%A7%A3%E6%83%912%E6%9C%9F.md.html">协议专栏特别福利 答疑解惑2期.md</a>

                    </li>
                    <li>

                        
                        <a href="%E5%8D%8F%E8%AE%AE%E4%B8%93%E6%A0%8F%E7%89%B9%E5%88%AB%E7%A6%8F%E5%88%A9%20%E7%AD%94%E7%96%91%E8%A7%A3%E6%83%913%E6%9C%9F.md.html">协议专栏特别福利 答疑解惑3期.md</a>

                    </li>
                    <li>

                        
                        <a href="%E5%8D%8F%E8%AE%AE%E4%B8%93%E6%A0%8F%E7%89%B9%E5%88%AB%E7%A6%8F%E5%88%A9%20%E7%AD%94%E7%96%91%E8%A7%A3%E6%83%914%E6%9C%9F.md.html">协议专栏特别福利 答疑解惑4期.md</a>

                    </li>
                    <li>

                        
                        <a href="%E5%8D%8F%E8%AE%AE%E4%B8%93%E6%A0%8F%E7%89%B9%E5%88%AB%E7%A6%8F%E5%88%A9%20%E7%AD%94%E7%96%91%E8%A7%A3%E6%83%915%E6%9C%9F.md.html">协议专栏特别福利 答疑解惑5期.md</a>

                    </li>
                    <li>

                        
                        <a href="%E7%BB%93%E6%9D%9F%E8%AF%AD%20%E6%94%BE%E5%BC%83%E5%AE%8C%E7%BE%8E%E4%B8%BB%E4%B9%89%EF%BC%8C%E6%89%A7%E8%A1%8C%E5%8A%9B%E5%B0%B1%E6%98%AF%E9%99%90%E6%97%B6%E9%99%90%E9%87%8F%E8%AE%A4%E7%9C%9F%E5%AE%8C%E6%88%90.md.html">结束语 放弃完美主义，执行力就是限时限量认真完成.md</a>

                    </li>
                </ul>

            </div>
        </div>

        <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
            <div class="sidebar-toggle-inner"></div>
        </div>

        <script>
            function add_inner() {
                let inner = document.querySelector('.sidebar-toggle-inner')
                inner.classList.add('show')
            }

            function remove_inner() {
                let inner = document.querySelector('.sidebar-toggle-inner')
                inner.classList.remove('show')
            }

            function sidebar_toggle() {
                let sidebar_toggle = document.querySelector('.sidebar-toggle')
                let sidebar = document.querySelector('.book-sidebar')
                let content = document.querySelector('.off-canvas-content')
                if (sidebar_toggle.classList.contains('extend')) { // show
                    sidebar_toggle.classList.remove('extend')
                    sidebar.classList.remove('hide')
                    content.classList.remove('extend')
                } else { // hide
                    sidebar_toggle.classList.add('extend')
                    sidebar.classList.add('hide')
                    content.classList.add('extend')
                }
            }


            function open_sidebar() {
                let sidebar = document.querySelector('.book-sidebar')
                let overlay = document.querySelector('.off-canvas-overlay')
                sidebar.classList.add('show')
                overlay.classList.add('show')
            }
            function hide_canvas() {
                let sidebar = document.querySelector('.book-sidebar')
                let overlay = document.querySelector('.off-canvas-overlay')
                sidebar.classList.remove('show')
                overlay.classList.remove('show')
            }

        </script>

        <div class="off-canvas-content">
            <div class="columns">
                <div class="column col-12 col-lg-12">
                    <div class="book-navbar">
                        <!-- For Responsive Layout -->
                        <header class="navbar">
                            <section class="navbar-section">
                                <a onclick="open_sidebar()">
                                    <i class="icon icon-menu"></i>
                                </a>
                            </section>
                        </header>
                    </div>
                    <div class="book-content" style="max-width: 960px; margin: 0 auto;
    overflow-x: auto;
    overflow-y: hidden;">
                        <div class="book-post">
                            <p id="tip" align="center"></p>
                            <div><h1>40 搭建一个网络实验环境：授人以鱼不如授人以渔</h1>
<p>因为这门课是基础课程，而且配合音频的形式发布，所以我多以理论为主来进行讲解。在专栏更新的过程中，不断有同学让我推荐一些网络方面的书籍，还有同学说能不能配合一些实验来说明理论。</p>
<p>的确，网络是一门实验性很强的学科，就像我在开篇词里面说的一样：<strong>一看觉得懂，一问就打鼓，一用就糊涂。</strong> 在写专栏的过程中，我自己也深深体会到了。这个时候，我常常会拿一个现实的环境，上手操作一下，抓个包看看，这样心里就会有定论。</p>
<h2>《TCP/IP详解》实验环境搭建</h2>
<p>对于网络方面的书籍，我当然首推Rechard Stevens的《<a href="https://book.douban.com/subject/1741925/">TCP/IP illustrated</a>》（《TCP/IP详解》）。这本书把理论讲得深入浅出，还配有大量的上手实践和抓包，看到这些抓包，原来不理解的很多理论，一下子就能懂了。</p>
<p>这本书里有个拓扑图，书上的很多实验都是基于这个图的，但是这个拓扑图还是挺复杂的。我这里先不说，一会儿详细讲。</p>
<p>Rechard Stevens，因为工作中有这么一个环境，很方便做实验，最终才写出了这样一本书，而我们一般人学习网络，没有这个环境应该怎么办呢？</p>
<p>时代不同了，咱们现在有更加强大的工具了。例如，这里这么多的机器，我们可以用Docker来实现，多个网络可以用Open vSwitch来实现。你甚至不需要一台物理机，只要一台1核2G的虚拟机，就能将这个环境搭建起来。</p>
<p>搭建这个环境的时候，需要一些脚本。我把脚本都放在了<a href="https://github.com/popsuper1982/tcpipillustrated">Github</a>里面，你可以自己取用。</p>
<h3>1.创建一个Ubuntu虚拟机</h3>
<p>在你的笔记本电脑上，用VirtualBox创建就行。1核2G，随便一台电脑都能搭建起来。</p>
<p>首先，我们先下载一个Ubuntu的镜像。我是从<a href="https://www.ubuntu.com/download/alternative-downloads">Ubuntu官方网站</a>下载的。</p>
<p><img src="assets/390a5bfb153fc95bdac0939194bc7387.jpg" alt="" /></p>
<p>然后，在VirtualBox里面安装Ubuntu。安装过程网上一大堆教程，你可以自己去看，我这里就不详细说了。</p>
<p>这里我需要说明的是网络的配置。</p>
<p>对于这个虚拟机，我们创建两个网卡，一个是Host-only，只有你的笔记本电脑上能够登录进去。这个网卡上的IP地址也只有在你的笔记本电脑上管用。这个网卡的配置比较稳定，用于在SSH上做操作。这样你的笔记本电脑就可以搬来搬去，在公司里安装一半，回家接着安装另一半都没问题。</p>
<p><img src="assets/ab1974fc25fe902ff8eeda598eb9c3ce.jpg" alt="" /></p>
<p>这里有一个虚拟的网桥，这个网络可以在管理&gt;主机网络管理里面进行配置。</p>
<p><img src="assets/49eea1f000c9a538271d46c25c0a7b13.jpg" alt="" /></p>
<p>在这里可以虚拟网桥的的IP地址，同时启用一个DHCP服务器，为新创建的虚拟机配置IP地址。</p>
<p>另一个网卡配置为NAT网络，用于访问互联网。配置了NAT网络之后，只要你的笔记本电脑能上网，虚拟机就能上网。由于咱们在Ubuntu里面要安装一些东西，因而需要联网。</p>
<p>你可能会问了，这个配置复杂吗？一点儿都不复杂。咱们讲[虚拟机网络]的时候，讲过这个。</p>
<p><img src="assets/2dd447992fbf4901f92a3dfdf8086bc4.jpg" alt="" /></p>
<p>安装完了Ubuntu之后，需要对Ubuntu里面的网卡进行配置。对于Ubuntu来讲，网卡的配置在/etc/network/interfaces这个文件里面。在我的环境里，NAT的网卡名称为enp0s3，Host-only的网卡的名称为enp0s8，都可以配置为自动配置。</p>
<pre><code>auto lo
iface lo inet loopback

auto enp0s3
iface enp0s3 inet dhcp

auto enp0s8
iface enp0s8 inet dhcp
</code></pre>
<p>这样，重启之后，IP就配置好了。</p>
<h3>2.安装Docker和Open vSwitch</h3>
<p>接下来，在Ubuntu里面，以root用户，安装Docker和Open vSwitch。</p>
<p>你可以按照Docker的<a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">官方安装</a><a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">文档</a>来做。我这里也贴一下我的安装过程。</p>
<pre><code>apt-get remove docker docker-engine docker.io
apt-get -y update
apt-get -y install apt-transport-https ca-certificates curl software-properties-common
curl -fsSL https://download.docker.com/linux/ubuntu/gpg &gt; gpg
apt-key add gpg
apt-key fingerprint 0EBFCD88
add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot;
apt-get -y update
apt-cache madison docker-ce
apt-get -y install docker-ce=18.06.0~ce~3-0~ubuntu
</code></pre>
<p>之后，还需要安装Open vSwitch和Bridge。</p>
<pre><code>apt-get -y install openvswitch-common openvswitch-dbg openvswitch-switch python-openvswitch openvswitch-ipsec openvswitch-pki openvswitch-vtep

apt-get -y install bridge-utils

apt-get -y install arping
</code></pre>
<h3>3.准备一个Docker的镜像</h3>
<p><img src="assets/4c0e633ddc53f3feb98946518c0cf21e.jpg" alt="" /></p>
<p>每个节点都是一个Docker，对应要有一个Docker镜像。这个镜像我已经打好了，你可以直接使用。</p>
<pre><code>docker pull hub.c.163.com/liuchao110119163/ubuntu:tcpip
</code></pre>
<p>当然你也可以自己打这个镜像。Dockerfile就像这样：</p>
<pre><code>FROM hub.c.163.com/public/ubuntu:14.04
RUN apt-get -y update &amp;&amp; apt-get install -y iproute2 iputils-arping net-tools tcpdump curl telnet iputils-tracepath traceroute
RUN mv /usr/sbin/tcpdump /usr/bin/tcpdump
ENTRYPOINT /usr/sbin/sshd -D
</code></pre>
<h3>4.启动整个环境</h3>
<p>启动这个环境还是比较复杂的，我写成了一个脚本。在Git仓库里面，有一个文件 <a href="http://setupenv.sh">setupenv.sh</a> ，可以执行这个脚本，里面有两个参数，一个参数是NAT网卡的名字，一个是镜像的名称。</p>
<pre><code>git clone https://github.com/popsuper1982/tcpipillustrated.git
cd tcpipillustrated
docker pull hub.c.163.com/liuchao110119163/ubuntu:tcpip
chmod +x setupenv.sh 
./setupenv.sh enp0s3 hub.c.163.com/liuchao110119163/ubuntu:tcpip
</code></pre>
<p>这样，整个环境就搭建起来了，所有的容器之间都可以ping通，而且都可以上网。</p>
<p>不过，我写的这个脚本对一些人来说可能会有点儿复杂，我这里也解释一下。</p>
<p>首先<strong>每一个节点，都启动一个容器</strong>。使用–privileged=true方式，网络先不配置–net none。有两个二层网络，使用ovs-vsctl的add-br命令，创建两个网桥。</p>
<p>pipework是一个很好的命令行工具，可以将容器连接到两个二层网络上。</p>
<p>但是我们上面那个图里有两个比较特殊的网络，一个是从slip到bsdi的P2P网络，需要创建一个peer的两个网卡，然后两个Docker的网络namespace里面各塞进去一个。</p>
<p>有关操作Docker的网络namespace的方式，咱们在[容器网络]那一节讲过ip netns命令。</p>
<p>这里需要注意的是，P2P网络和下面的二层网络不是同一个网络。P2P网络的CIDR是140.252.13.64/27，而下面的二层网络的CIDR是140.252.13.32/27。如果按照/24，看起来是一个网络，但是/27就不是了。至于[CIDR的计算方法]，你可以回去复习一下。</p>
<p>另外需要<strong>配置从sun到netb的点对点网络</strong>，方法还是通过peer网卡和ip netns的方式。</p>
<p>这里有个特殊的地方，对于netb来讲，不是一个普通的路由器，因为netb两边是同一个二层网络，所以需要配置arp proxy。</p>
<p>为了所有的节点之间互通，要配置一下路由策略，这里需要通过ip route命令。</p>
<ul>
<li>
<p>对于slip来讲，bsdi左面13.66这个网口是网关。</p>
</li>
<li>
<p>对于bsdi和svr4来讲，如果去外网，sun下面的网口13.33是网关。</p>
</li>
<li>
<p>对于sun来讲，上面的网口1.29属于上面的二层网络了，它如果去外网，gateway下面的网口1.4就是外网网关。</p>
</li>
<li>
<p>对于aix，solaris，gemini来讲，如果去外网，网关也是gateway下面的网口1.4。如果去下面的二层网口，网关是sun上面的网口1.29。</p>
</li>
</ul>
<p>配置完了这些，图中的所有的节点都能相互访问了，最后还要解决<strong>如何访问外网</strong>的问题。</p>
<p>我们还是需要创建一个peer网卡对。一个放在gateway里面，一个放在gateway外面。外面的网卡去外网的网关。</p>
<p>在虚拟机上面，还需要配置一个iptables的地址伪装规则MASQUERADE，其实就是一个SNAT。因为容器里面要访问外网，因为外网是不认的，所以源地址不能用容器的地址，需要SNAT成为虚拟机的地址出去，回来的时候再NAT回来。</p>
<p>配置这个环境还是挺复杂的，要用到咱们学到的很多知识。如果没有学习前面那些知识，直接就做这个实验，你肯定会很晕。但是只学理论也不行，要把理论都学过一遍，再做一遍实验，这才是一个不断迭代、更新知识库的过程。</p>
<p>有了这个环境，《TCP/IP详解》里面的所有实验都能做了，而且我打的这个Docker镜像里面，tcpdump等网络工具都安装了，你可以“为所欲为”了。</p>
<h2>Open vSwitch的实验</h2>
<p>做了TCP/IP详解的实验之后，网络程序设计这部分，你就有了坚实的基础。但是涉及到数据中心内部的一些网络技术，什么VLAN、VXLAN、STP等偏运维方向的，学习还是会比较困难。好在我们有Open vSwitch，也可以做大量的实验。</p>
<p>Open vSwitch门槛比较高，里面的概念也非常多，可谓千头万绪。不过，通过我这么多年研究的经验，可以告诉你，这里面有一个很好的线索，那就是Open vSwitch会将自己对于网络的配置保存在一个本地库里面。这个库的表结构之间的关系就像这样：</p>
<p><img src="assets/439a996b7f8de9477cb00876f13a28d9.jpg" alt="" /></p>
<p>这个库其实是一个JSON，如果把这个JSON打印出来，能够看到更加详细的特性。按照这些特性一一实验，可以逐渐把Open vSwitch各个特性都掌握。</p>
<p><img src="assets/f00657f044e5afb07332f7236054b8a0.jpg" alt="" /></p>
<p>这里面最重要的概念就是<strong>网桥</strong>。一个网桥会有流表控制网络包的处理过程，会有控制器下发流表，一个网桥上会有多个端口，可以对端口进行流控，一个端口可以设置VLAN，一个端口可以包含多个网卡，可以做绑定，网卡可以设置成为GRE和VXLAN。</p>
<p>我写过一个Open vSwitch的实验教程，也放在了Github里面。这里面有这么几个比较重要的实验，你可以看一看。</p>
<ul>
<li>
<p>实验一：查看Open vSwitch的架构。我们在讲Open vSwitch的时候，提过Open vSwitch的架构，在这个实验中，我们可以查看Open vSwitch的各个模块以及启动的参数。</p>
</li>
<li>
<p>实验五：配置使用OpenFlow Controller，体验一把作为小区物业在监控室里面管控整个小区道路的样子。</p>
</li>
<li>
<p>实验八：测试Port的VLAN功能。看一下VLAN隔离究竟是什么样的。</p>
</li>
<li>
<p>实验十：QoS功能。体验一把如果使用HTB进行网卡限流。</p>
</li>
<li>
<p>实验十一：GRE和VXLAN隧道功能，看虚拟网络如何进行租户隔离。</p>
</li>
<li>
<p>实验十五：对Flow Table的操作，体验流表对网络包随心所欲的处理。</p>
</li>
</ul>
<p>好了，关于整个环境的搭建我就讲到这里了。</p>
<p>其实到这里，对于网络世界的探索才刚刚开始，只有经过你自己动手和思考产生的内容，才是真正属于你的知识！打开你的电脑，上手去实验吧！</p>
<p>欢迎你留言和我讨论。趣谈网络协议，我们下期见！</p>
</div>
                        </div>
                        <div>
                            <div style="float: left">
                                <a href="39%20%E7%9F%A5%E8%AF%86%E4%B8%B2%EF%BC%9A%E7%94%A8%E5%8F%8C%E5%8D%81%E4%B8%80%E7%9A%84%E6%95%85%E4%BA%8B%E4%B8%B2%E8%B5%B7%E7%A2%8E%E7%89%87%E7%9A%84%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%EF%BC%88%E4%B8%8B%EF%BC%89.md.html">上一页</a>
                            </div>
                            <div style="float: right">
                                <a href="%E5%8A%A0%E9%A4%901%20%E5%88%9B%E4%BD%9C%E6%95%85%E4%BA%8B%EF%BC%9A%E6%88%91%E6%98%AF%E5%A6%82%E4%BD%95%E5%88%9B%E4%BD%9C%E2%80%9C%E8%B6%A3%E8%B0%88%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE%E2%80%9D%E4%B8%93%E6%A0%8F%E7%9A%84%EF%BC%9F.md.html">下一页</a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="copyright"><p>© 2019 - 2023 <a href="../../cdn-cgi/l/email-protection.html#d4b8b8b8ede0e5e5e4e394b3b9b5bdb8fab7bbb9" target="_blank">Liangliang Lee</a>. Powered by <a href="https://vertx.io/" target="_blank">Vert.x</a> and <a href="https://github.com/kaiiiz/hexo-theme-book" target="_blank">hexo-theme-book</a>.</p></div>
        </div>

        <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
    </div>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vb26e4fa9e5134444860be286fd8771851679335129114" integrity="sha512-M3hN/6cva/SjwrOtyXeUa5IuCT0sedyfT+jK/OV+s+D0RnzrTfwjwJHhd+wYfMm9HJSrZ1IKksOdddLuN6KOzw==" data-cf-beacon='{"rayId":"7af42bb179eece54","version":"2023.3.0","r":1,"token":"1f5d475227ce4f0089a7cff1ab17c0f5","si":100}' crossorigin="anonymous"></script>
</body>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NPSEEVD756"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-NPSEEVD756');
    var path = window.location.pathname
    var cookie = getCookie("lastPath");
    console.log(path)
    if (path.replace("/", "") === "") {
        if (cookie.replace("/", "") !== "") {
            console.log(cookie)
            document.getElementById("tip").innerHTML = "<a href='" + cookie + "'>跳转到上次进度</a>"
        }
    } else {
        setCookie("lastPath", path)
    }

    function setCookie(cname, cvalue) {
        var d = new Date();
        d.setTime(d.getTime() + (180 * 24 * 60 * 60 * 1000));
        var expires = "expires=" + d.toGMTString();
        document.cookie = cname + "=" + cvalue + "; " + expires + ";path = /";
    }

    function getCookie(cname) {
        var name = cname + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i].trim();
            if (c.indexOf(name) === 0) return c.substring(name.length, c.length);
        }
        return "";
    }

    hljs.initHighlightingOnLoad()

</script>

</html>
