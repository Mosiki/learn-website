<!DOCTYPE html>
<!-- saved from url=(0046)https://kaiiiz.github.io/hexo-theme-book-demo/ -->
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
        <link rel="icon" href="../../static/favicon.png">
        <title>15 插件荟萃：不可或缺的插件.md</title>
        <!-- Spectre.css framework -->
        <link rel="stylesheet" href="../../static/index.css">
        <link rel="stylesheet"
              href="../../static/highlight.min.css">
        <script src="../../static/highlight.min.js"></script>
        <!-- theme css & js -->
        <meta name="generator" content="Hexo 4.2.0">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5295275829820252"
                crossorigin="anonymous"></script>
        <script async defer data-website-id="83e5d5db-9d06-40e3-b780-cbae722fdf8c" src="https://analyze.lianglianglee.com/umami.js"></script>
    </head>

<body>

    <div class="book-container">
        <div class="book-sidebar">
            <div class="book-brand">
                <a href="../../index.html">
                    <img src="../../static/favicon.png">
                    <span>技术文章摘抄</span>
                </a>
            </div>
            <div class="book-menu uncollapsible">
                <ul class="uncollapsible">
                    <li><a href="../../index.html" class="current-tab">首页</a></li>
                </ul>

                <ul class="uncollapsible">
                    <li><a href="../index.html">上一级</a></li>
                </ul>

                <ul class="uncollapsible">
                    <li>

                        
                        <a href="00%20%E5%AF%BC%E8%AF%BB%20%E6%B1%A0%E5%BB%BA%E5%BC%BA%EF%BC%9AVim%20%E5%B0%B1%E6%98%AF%E5%9B%9B%E4%B8%AA%E5%AD%97%E2%80%9C%E5%94%AF%E5%BF%AB%E4%B8%8D%E7%A0%B4%E2%80%9D.md.html">00 导读 池建强：Vim 就是四个字“唯快不破”.md</a>

                    </li>
                    <li>

                        
                        <a href="00%20%E5%BC%80%E7%AF%87%E8%AF%8D%20%E6%88%91%E4%BB%AC%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%AD%A6%20Vim%EF%BC%9F.md.html">00 开篇词 我们为什么要学 Vim？.md</a>

                    </li>
                    <li>

                        
                        <a href="01%20%E5%90%84%E5%B9%B3%E5%8F%B0%E4%B8%8B%E7%9A%84%20Vim%20%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95%EF%BC%9A%E4%B8%8A%E8%B7%AF%E5%89%8D%E5%87%86%E5%A4%87%E5%A5%BD%E4%BD%A0%E7%9A%84%E5%AE%9D%E9%A9%AC.md.html">01 各平台下的 Vim 安装方法：上路前准备好你的宝马.md</a>

                    </li>
                    <li>

                        
                        <a href="02%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4%EF%BC%9A%E5%BA%94%E5%AF%B9%E7%AE%80%E5%8D%95%E7%9A%84%E7%BC%96%E8%BE%91%E4%BB%BB%E5%8A%A1.md.html">02 基本概念和基础命令：应对简单的编辑任务.md</a>

                    </li>
                    <li>

                        
                        <a href="03%20%E6%9B%B4%E5%A4%9A%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%EF%BC%9A%E5%BA%94%E5%AF%B9%E7%A8%8D%E5%A4%8D%E6%9D%82%E7%9A%84%E7%BC%96%E8%BE%91%E4%BB%BB%E5%8A%A1.md.html">03 更多常用命令：应对稍复杂的编辑任务.md</a>

                    </li>
                    <li>

                        
                        <a href="04%20%E5%88%9D%E6%AD%A5%E5%AE%9A%E5%88%B6%EF%BC%9A%E8%AE%A9%E4%BD%A0%E7%9A%84%20Vim%20%E6%9B%B4%E9%A1%BA%E6%89%8B.md.html">04 初步定制：让你的 Vim 更顺手.md</a>

                    </li>
                    <li>

                        
                        <a href="05%20%E5%A4%9A%E6%96%87%E4%BB%B6%E6%89%93%E5%BC%80%E4%B8%8E%E7%BC%93%E5%86%B2%E5%8C%BA%EF%BC%9A%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF.md.html">05 多文件打开与缓冲区：复制粘贴的正确姿势.md</a>

                    </li>
                    <li>

                        
                        <a href="06%20%E7%AA%97%E5%8F%A3%E5%92%8C%E6%A0%87%E7%AD%BE%E9%A1%B5%EF%BC%9A%E4%BF%AE%E6%94%B9%E3%80%81%E5%AF%B9%E6%AF%94%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF.md.html">06 窗口和标签页：修改、对比多个文件的正确姿势.md</a>

                    </li>
                    <li>

                        
                        <a href="07%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%9A%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E7%9A%84%E6%90%9C%E7%B4%A2%E5%92%8C%E6%9B%BF%E6%8D%A2.md.html">07 正则表达式：实现文件内容的搜索和替换.md</a>

                    </li>
                    <li>

                        
                        <a href="08%20%E5%9F%BA%E6%9C%AC%E7%BC%96%E7%A8%8B%E6%94%AF%E6%8C%81%EF%BC%9A%E8%A7%84%E9%81%BF%E3%80%81%E8%A7%A3%E5%86%B3%E7%BC%96%E7%A8%8B%E6%97%B6%E7%9A%84%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98.md.html">08 基本编程支持：规避、解决编程时的常见问题.md</a>

                    </li>
                    <li>

                        
                        <a href="09%20%E4%B8%83%E5%A4%A7%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7%EF%BC%9A%E8%AE%A9%E7%BC%96%E8%BE%91%E6%95%88%E7%8E%87%E5%86%8D%E4%B8%8A%E4%B8%80%E4%B8%AA%E5%8F%B0%E9%98%B6.md.html">09 七大常用技巧：让编辑效率再上一个台阶.md</a>

                    </li>
                    <li>

                        
                        <a href="10%20%E4%BB%A3%E7%A0%81%E9%87%8D%E6%9E%84%E5%AE%9E%E9%AA%8C%EF%BC%9A%E5%9C%A8%E5%AE%9E%E6%88%98%E4%B8%AD%E6%8F%90%E9%AB%98%E7%BC%96%E8%BE%91%E7%86%9F%E7%BB%83%E5%BA%A6.md.html">10 代码重构实验：在实战中提高编辑熟练度.md</a>

                    </li>
                    <li>

                        
                        <a href="11%20%E6%96%87%E6%9C%AC%E7%9A%84%E7%BB%86%E8%8A%82%EF%BC%9A%E5%85%B3%E4%BA%8E%E5%AD%97%E7%AC%A6%E3%80%81%E7%BC%96%E7%A0%81%E3%80%81%E8%A1%8C%E4%BD%A0%E6%89%80%E9%9C%80%E8%A6%81%E7%9F%A5%E9%81%93%E7%9A%84%E4%B8%80%E5%88%87.md.html">11 文本的细节：关于字符、编码、行你所需要知道的一切.md</a>

                    </li>
                    <li>

                        
                        <a href="12%20%E8%AF%AD%E6%B3%95%E5%8A%A0%E4%BA%AE%E5%92%8C%E9%85%8D%E8%89%B2%E6%96%B9%E6%A1%88%EF%BC%9A%E9%A2%9C%E5%8D%B3%E6%AD%A3%E4%B9%89.md.html">12 语法加亮和配色方案：颜即正义.md</a>

                    </li>
                    <li>

                        
                        <a href="13%20YouCompleteMe%EF%BC%9AVim%20%E9%87%8C%E7%9A%84%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90.md.html">13 YouCompleteMe：Vim 里的自动完成.md</a>

                    </li>
                    <li>

                        
                        <a href="14%20Vim%20%E8%84%9A%E6%9C%AC%E7%AE%80%E4%BB%8B%EF%BC%9A%E5%BC%80%E5%A7%8B%E4%BD%A0%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AE%9A%E5%88%B6.md.html">14 Vim 脚本简介：开始你的深度定制.md</a>

                    </li>
                    <li>

                        <a class="current-tab" href="15%20%E6%8F%92%E4%BB%B6%E8%8D%9F%E8%90%83%EF%BC%9A%E4%B8%8D%E5%8F%AF%E6%88%96%E7%BC%BA%E7%9A%84%E6%8F%92%E4%BB%B6.md.html">15 插件荟萃：不可或缺的插件.md</a>
                        

                    </li>
                    <li>

                        
                        <a href="16%20%E7%BB%88%E7%AB%AF%E5%92%8C%20GDB%20%E6%94%AF%E6%8C%81%EF%BC%9A%E4%B8%8D%E7%A6%BB%E5%BC%80%20Vim%20%E5%AE%8C%E6%88%90%E5%BC%80%E5%8F%91%E4%BB%BB%E5%8A%A1.md.html">16 终端和 GDB 支持：不离开 Vim 完成开发任务.md</a>

                    </li>
                    <li>

                        
                        <a href="%E6%8B%93%E5%B1%951%20%E7%BA%AF%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%EF%BC%9A%E4%BD%BF%E7%94%A8%20Vim%20%E4%B9%A6%E5%86%99%E4%B8%AD%E8%8B%B1%E6%96%87%E6%96%87%E6%A1%A3.md.html">拓展1 纯文本编辑：使用 Vim 书写中英文文档.md</a>

                    </li>
                    <li>

                        
                        <a href="%E6%8B%93%E5%B1%952%20C%20%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%20Vim%20%E5%B7%A5%E4%BD%9C%E7%8E%AF%E5%A2%83%EF%BC%9AC%20%E4%BB%A3%E7%A0%81%E7%9A%84%E6%90%9C%E7%B4%A2%E3%80%81%E6%8F%90%E7%A4%BA%E5%92%8C%E8%87%AA%E5%8A%A8%E5%AE%8C%E6%88%90.md.html">拓展2 C 程序员的 Vim 工作环境：C 代码的搜索、提示和自动完成.md</a>

                    </li>
                    <li>

                        
                        <a href="%E6%8B%93%E5%B1%953%20Python%20%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%20Vim%20%E5%B7%A5%E4%BD%9C%E7%8E%AF%E5%A2%83%EF%BC%9A%E5%AE%8C%E6%95%B4%E7%9A%84%20Python%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.md.html">拓展3 Python 程序员的 Vim 工作环境：完整的 Python 开发环境.md</a>

                    </li>
                    <li>

                        
                        <a href="%E6%8B%93%E5%B1%954%20%E6%8F%92%E4%BB%B6%E6%A0%B7%E4%BE%8B%E5%88%86%E6%9E%90%EF%BC%9A%E8%87%AA%E5%B7%B1%E5%8A%A8%E6%89%8B%E6%94%B9%E8%BF%9B%E6%8F%92%E4%BB%B6.md.html">拓展4 插件样例分析：自己动手改进插件.md</a>

                    </li>
                    <li>

                        
                        <a href="%E6%8B%93%E5%B1%955%20%E5%85%B6%E4%BB%96%E6%8F%92%E4%BB%B6%E5%92%8C%E6%8A%80%E5%B7%A7%EF%BC%9A%E5%90%B4%E5%92%8F%E7%82%9C%E7%9A%84%E7%AE%B1%E5%BA%95%E7%A7%81%E8%97%8F.md.html">拓展5 其他插件和技巧：吴咏炜的箱底私藏.md</a>

                    </li>
                    <li>

                        
                        <a href="%E7%BB%93%E6%9D%9F%E8%AF%AD%20Vim%20%E6%A3%AE%E6%9E%97%E6%8E%A2%E7%A7%98%EF%BC%8C%E4%B8%80%E5%88%87%E6%89%8D%E5%88%9A%E5%88%9A%E5%BC%80%E5%A7%8B.md.html">结束语 Vim 森林探秘，一切才刚刚开始.md</a>

                    </li>
                </ul>

            </div>
        </div>

        <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
            <div class="sidebar-toggle-inner"></div>
        </div>

        <script>
            function add_inner() {
                let inner = document.querySelector('.sidebar-toggle-inner')
                inner.classList.add('show')
            }

            function remove_inner() {
                let inner = document.querySelector('.sidebar-toggle-inner')
                inner.classList.remove('show')
            }

            function sidebar_toggle() {
                let sidebar_toggle = document.querySelector('.sidebar-toggle')
                let sidebar = document.querySelector('.book-sidebar')
                let content = document.querySelector('.off-canvas-content')
                if (sidebar_toggle.classList.contains('extend')) { // show
                    sidebar_toggle.classList.remove('extend')
                    sidebar.classList.remove('hide')
                    content.classList.remove('extend')
                } else { // hide
                    sidebar_toggle.classList.add('extend')
                    sidebar.classList.add('hide')
                    content.classList.add('extend')
                }
            }


            function open_sidebar() {
                let sidebar = document.querySelector('.book-sidebar')
                let overlay = document.querySelector('.off-canvas-overlay')
                sidebar.classList.add('show')
                overlay.classList.add('show')
            }
            function hide_canvas() {
                let sidebar = document.querySelector('.book-sidebar')
                let overlay = document.querySelector('.off-canvas-overlay')
                sidebar.classList.remove('show')
                overlay.classList.remove('show')
            }

        </script>

        <div class="off-canvas-content">
            <div class="columns">
                <div class="column col-12 col-lg-12">
                    <div class="book-navbar">
                        <!-- For Responsive Layout -->
                        <header class="navbar">
                            <section class="navbar-section">
                                <a onclick="open_sidebar()">
                                    <i class="icon icon-menu"></i>
                                </a>
                            </section>
                        </header>
                    </div>
                    <div class="book-content" style="max-width: 960px; margin: 0 auto;
    overflow-x: auto;
    overflow-y: hidden;">
                        <div class="book-post">
                            <p id="tip" align="center"></p>
                            <div><h1>15 插件荟萃：不可或缺的插件</h1>
<p>你好，我是吴咏炜。</p>
<p>关于 Vim 的基本知识，我们已经讨论得差不多了。下面，我们需要的是练习和积累，在实践中成长。在今天的这一讲里，我们就来看看一些我们之前还没来得及介绍、但真的“必需”的插件，让你的开发效率再进行一次大幅提升。</p>
<p>跟之前各讲比起来，这讲会比较轻松。不过，在你已经学过了 Vim 的基本原理之后（特别是如果你学习了[拓展 4]的样例，进一步了解了插件代码是如何编写的话），我希望你看到这些插件时，不仅可以看到它们的外观和用法，而且还能大概知道它们的工作原理。这样，你就不再仅仅是一个初级用户，而是已经晋升为真正的 Vim 高手，能够根据自己的需要进行定制，甚至是“魔改”了。</p>
<h2>Fugitive</h2>
<p>对于大部分开发者来说，使用 Git 应该已经和呼吸空气一样自然了吧。我跟很多工作经历丰富的开发者一样，从 CVS 的年代开始（那时我还一直维护着 <a href="https://www.vim.org/scripts/script.php?script_id=1245">CVSMenu</a>），经历了 SVN，然后看着 Git 慢慢一统天下，号令江湖。在 Vim 中如何高效地使用 Git，当然也就成了个不得不讨论的话题。</p>
<p>今天，我会介绍两个 Git 插件。一个是重量级的、功能很多的 Fugitive，一个是集中在几个特色小功能上的 GitGutter。下面我们就从 Fugitive 开始。</p>
<h3>安装和配置</h3>
<p><a href="https://github.com/tpope/vim-fugitive">Fugitive</a> 是纯 Vim 脚本，我们使用包管理器安装 tpope/vim-fugitive 即可（对了，他也是 Time Pope 大牛写的）。</p>
<p>这个插件基本上不需要配置，即装即用。</p>
<h3>使用</h3>
<p>Fugitive 是一个全功能的 Git 支持插件，支持在 Vim 里直接使用 Git 命令：你只需要把“G”变成大写即可。比如，原本你要在 shell 使用 <code>git log</code>，现在在 Vim 里使用 <code>:Git log</code> 命令即可。结果会在一个 Vim 窗口里打开，并且有着语法加亮的效果：</p>
<p><img src="assets/1d33862fae5ce87d891116770f254587.png" alt="Fig15.1" title=":Git log 命令的效果" /></p>
<p>Fugitive 有很多命令，你可以在它的帮助文件里找到较为完整的信息。下面我从使用的角度说明一下最常用的命令，重点是对当前文件操作的命令。像 <code>:Git pull</code> 这样的命令，我就略过不讲啦。</p>
<p>首先，要把当前文件的修改存盘并加到 Git 的暂存区，可以使用 <code>:Gwrite</code>。</p>
<p>反过来，要放弃当前的修改，回到暂存区的状态，可以使用 <code>:Gread</code>。</p>
<p>如果你需要对当前文件进行移动、更名或删除，可以分别使用 <code>:GMove</code>、<code>:GRename</code>、<code>:GDelete</code>。跟命令行上的 git 命令不同，你不需要给出当前文件的名字。</p>
<p>要在 quickfix 窗口里查看当前文件的修改历史，可以使用 <code>:0Gclog</code>（<code>Gclog</code> 是查看整个项目的历史，对大项目使用 quickfix 窗口可能会有性能问题）。同时，你可以通过历史窗口，回到这个文件的任一版本。</p>
<p><img src="assets/a15e57500c55e5285da5c712f5076839.png" alt="Fig15.2" title=":0Gclog 命令的效果" /></p>
<p>要查看文件的某一行是谁最后修改的，可以使用 <code>:Git blame</code> 命令。你不需要给出当前文件的名字，而且 Fugitive 会把输出放到一个跟当前文件编辑窗口联动的新窗口里，并进行了色彩加亮。</p>
<p><img src="assets/67f1234d97b07e263b3f5yyyy75136a6.gif" alt="Fig15.3" title=":Git blame 命令的效果" /></p>
<p>要比较当前文件和暂存区版本的区别，可以使用命令 <code>:Gvdiff</code>。</p>
<p><img src="assets/9bb1805d2b287cba0a415788c80b3639.png" alt="Fig15.4" title=":Gvdiff 命令的效果" /></p>
<p>要查看当前 Git 库的状态，可以直接输入 <code>:Git</code> 命令。在结果缓冲区里，有很多正常模式命令可用（见 <code>:help fugitive-staging-maps</code>）。其中最实用的可能是：</p>
<ul>
<li>使用 <code>s</code> 来把文件（整个文件）或光标下的修改（部分修改）加到暂存区中</li>
<li>使用 <code>u</code> 来重置加入暂存区的修改（撤销 <code>s</code>）</li>
<li>使用 <code>=</code> 来切换开关这个文件的内联 diff 显示</li>
<li>使用 <code>o</code> 来在新分割的窗口中打开文件</li>
<li>使用 <code>dv</code> 来比较文件和暂存区版本的区别</li>
<li>使用 <code>cc</code> 来签入（commit）当前暂存区中的文件，相当于 <code>:Git commit</code> 命令</li>
</ul>
<p><img src="assets/ee3479c8f61b666d7bea2077b9238f45.gif" alt="Fig15.5" title="在 :Git 命令后使用部分快捷键" /></p>
<p>最后，<code>:Git push</code> 本来是不需要解释的，但你可能会高兴知道，在安装了 AsyncRun（见[第 8 讲]）之后，这个操作自动就是异步的，不会在操作完成之前妨碍你继续进行编辑。</p>
<p>此外，所有的 <code>:Git …</code> 命令都可以打字成 <code>:G …</code>，事实上，之前给出的命令清单里，连这个空格都不要，所以你可以输入 <code>:Gpush</code> 来代替 <code>:G push</code>。不过，作者宣称 <code>:Gblame</code> 和 <code>:Gpush</code> 这样的命令在将来的版本里可能会被删除，所以你如果在用 <code>:Gpush</code> 这样的命令的话，可能需要知道一下这个事情。</p>
<p>你已经可以看到，Fugitive 的命令是相当复杂的，毕竟 Git 也很复杂。我上面讨论的，只是它的功能的一部分。你可以在它的帮助文件中了解进一步的信息（<code>:help fugitive</code>）。</p>
<h2>GitGutter</h2>
<p>如果说 Fugitive 是一个全功能 Git 插件的话，<a href="https://github.com/airblade/vim-gitgutter">GitGutter</a> 就只是 Git 使用中的一个非常小的点。它的功能列出来也可以有不少，但跟 Fugitive 不同，它专注在<strong>单个文件内的修改管理</strong>上。</p>
<h3>安装和配置</h3>
<p>你需要使用包管理器安装 airblade/vim-gitgutter。如果你使用了一个比较知名的配色方案的话，多半你不需要额外配置了。GitGutter 会试图从配色方案里找出合适的颜色，但这个方法对配色方案会比较挑，尤其是对默认配色方案不适用。如果你觉得边栏或边栏里符号的颜色不让人满意的话，可以在 vimrc 配置文件中作类似于下面的配置：</p>
<pre><code>highlight! link SignColumn LineNr
highlight GitGutterAdd    guifg=#009900 ctermfg=2
highlight GitGutterChange guifg=#bbbb00 ctermfg=3
highlight GitGutterDelete guifg=#ff2222 ctermfg=1
let g:gitgutter_set_sign_backgrounds = 1
</code></pre>
<p>没有上面那样的配置的话，在简单配色方案（如 Vim 的默认配色方案）下，GitGutter 的默认设置会出现突兀的边栏和无色的符号，丑得让人无法接受。</p>
<p><img src="assets/bd438ca715cfdea46cf1869f80522bcc.png" alt="Fig15.6" title="默认配色方案下的 GitGutter 效果" /></p>
<h3>使用</h3>
<p>下面的动图展示了 GitGutter 的核心功能（使用 gruvbox 配色方案）：</p>
<p><img src="assets/6782e2ebd3216bb6d6681b620a9f0b87.gif" alt="Fig15.7" title="GitGutter 的功能展示" /></p>
<p>简单说明一下：</p>
<ul>
<li>在 Vim 的边栏里用 <code>+</code>、<code>-</code> 等符号和合适的配色来标注哪些行有了修改</li>
<li><code>[c</code> 和 <code>]c</code> 可以用来跳转到上一个和下一个修改的位置</li>
<li><code>&lt;Leader&gt;hp</code> 可以将光标下的修改块和缓存区中的内容进行对比</li>
<li><code>&lt;Leader&gt;hs</code> 可以将光标下的修改块加入到暂存区中</li>
<li><code>&lt;Leader&gt;hu</code> 可以恢复暂存区中的内容</li>
</ul>
<p>换句话说，GitGutter 的重点是一个文件内修改的管理——这个功能 Fugitive 可以说也有（在 <code>:Git</code> 命令下管理），但不及 GitGutter 直观。使用 GitGutter，你可以在编辑文件时，立即选择把部分修改加入暂存区，方便后续的签入。因此，虽然看起来 GitGutter 的功能不多，我使用它的频度跟 Fugitive 差不多。</p>
<h2>Airline</h2>
<p>如果你认为界面的美观很重要的话，你多半也会喜欢 <a href="https://github.com/vim-airline/vim-airline">Airline</a>。Airline 应该可以算是 Vim 中最流行的插件之一了。它会和很多其他知名 Vim 插件自动进行集成，并在界面上展示非常丰富的信息。事实上，我在开篇词中给出的 Vim 界面截图中就使用了 Airline。我们这儿再重新展示一下。</p>
<p><img src="assets/d71beed8a4e1e2b970c63f7317655yyc.png" alt="Fig15.8" title="启用了 Airline 的 Vim 界面" /></p>
<p>靠近底部、开头是“NORMAL”的那行状态栏就是由 Airline 控制的。我们可以看到其中有非常丰富的信息：</p>
<ul>
<li>当前的模式直接显示在状态栏上，并且每种模式都有自己的特别颜色，可以一目了然（在 gruvbox 提供的配色里，插入模式和可视模式的背景色都比目前的要突出得多）。</li>
<li>后面紧跟着的分支符号和“master”是 Airline 检测到了 Fugitive，通过 Fugitive 获得了分支名称。</li>
<li>后面跟着的是文件名和修改标记。</li>
<li>再后面，我们可以看到光标所在的位置的函数名，这是 Airline 通过 Tagbar 获得的。</li>
<li>随后，我们看到文件类型 cpp。</li>
<li>最后，我们看到光标位置在文件中的行数百分比、行号、总行数和列号，通过一些花哨的 Unicode 符号来进行分隔。</li>
</ul>
<p>这些只是 Airline 功能的一部分。事实上，它内部有对超过 50 个 Vim 插件的集成扩展，会自动检测它们的存在，并显示相关信息。要看到这些扩展的完整列表和当前状态，可以使用 <code>:AirlineExtensions</code> 命令。</p>
<h3>安装和配置</h3>
<p>Airline 本身的安装非常简单，通过包管理器安装 vim-airline/vim-airline 即可。不过，要显示出比较好（kù）的效果，你需要有一个支持它用到的特殊字符的字体。这些字体常常被叫做 Powerline 字体，原因是一个叫 Powerline 的插件最早开始使用这些特殊符号。（Airline 也算是 Powerline 的一个替代品了，不过，两者还是有点区别的，其中之一就是，Powerline 要求 Python 支持，而 Airline 是纯 Vim 脚本。）</p>
<p>下面这几个是我比较推荐的：</p>
<ul>
<li><a href="https://github.com/adobe-fonts/source-code-pro">Source Code Pro</a>：一款设计非常优秀的字体，不花哨，但耐看</li>
<li><a href="https://github.com/tonsky/FiraCode">Fira Code</a>：这是一款非常花哨的好字体（如果你疑惑上一张图里居然有“→”，就是这个字体对 <code>-&gt;</code> 的特殊渲染），也支持 Airline 需要的特殊符号</li>
<li><a href="https://github.com/powerline/fonts/tree/master/DejaVuSansMono">DejaVu Sans Mono for Powerline</a>：著名的开源字体 DejaVu Sans Mono 加入了特殊符号支持的版本</li>
</ul>
<p>在我目前的 vimrc 配置文件中，我对 Airline 进行了下面这样的配置：</p>
<pre><code>let g:airline_powerline_fonts = 1
let g:airline#extensions#tabline#enabled = 1
let g:airline#extensions#tabline#buffer_nr_show = 1
let g:airline#extensions#tabline#overflow_marker = '…'
let g:airline#extensions#tabline#show_tab_nr = 0
</code></pre>
<p>首先，我告诉 Airline，可以使用 Powerline 字体来显示特殊符号。</p>
<p>其次，我启用 tabline 扩展，在顶部显示缓冲区列表。</p>
<p>再次，我让 tabline 显示缓冲区的编号，这样方便我使用数字加 <code>&lt;C-^&gt;</code> 来切换缓冲区。</p>
<p>然后，我使用 <code>…</code> 来表示省略（单个字符，而非占据三列的三个点），这样可以节约一点屏幕空间。</p>
<p>最后，我一般不在一个 Vim 会话中打开很多个标签页，一般使用上一个、下一个标签页的命令来进行切换，所以也就不需要显示标签页的编号了，免得和缓冲区编号两个显示在一起会比较乱。</p>
<p>这样配置下的效果，可以参见下面的截图（图中的字体是 Source Code Pro）：</p>
<p><img src="assets/9a1afd2422ac186c6e835c0e6a545c5a.png" alt="Fig15.9" title="配置了显示缓冲区编号的 Vim 界面" /></p>
<p>哦，对了，下面的那个闪电符号也是 Airline 搞出来了，提醒你当前的 Git 库里有没有提交的更改。</p>
<h3>使用</h3>
<p>Airline 的使用基本上是自动的，安装、配置完了，差不多就不用去管它了。留意看它的提示就行了。比如，它会在右下角进行可能错误的显示提示，包括行尾的空格（trailing space），YCM 发现的代码错误，等等。</p>
<p>Airline 还提供了一些命令，如 <code>:AirlineExtensions</code> 和 <code>AirlineToggle</code>。这些你直接看帮助文档（<code>:help airline</code>）就应该可以清楚了。</p>
<h2>NERDCommenter</h2>
<p>我们前面已经介绍过了 NERDTree，而同一个作者写的另外一个插件 <a href="https://github.com/preservim/nerdcommenter">NERDCommenter</a>，也在我的不可或缺的 Vim 插件的列表上。它提供的是又一个开发常用的功能，对某个代码块或代码行加上注释，及反过来把注释去掉。</p>
<h3>安装和配置</h3>
<p>我们需要在包管理器中安装 preservim/nerdcommenter。然后，我一般在 vimrc 配置文件中加入下面的代码，让 NERDCommenter 不要在终端 Vim 中加入菜单，干扰我使用 <code>&lt;F10&gt;</code> 查看最近的文件：</p>
<pre><code>if !has('gui_running')
  let g:NERDMenuMode = 0
endif
</code></pre>
<h3>使用</h3>
<p>NERDTree 提供的命令，有些可以工作于当前行或选定的行内部分字符，有些则只能工作于整行，即使用可视模式的话选行内部分字符相当于选了整行。能够适用于行内的有下面这些命令（也能适用于整行）：</p>
<ul>
<li><code>&lt;Leader&gt;cc</code> 把代码变为注释</li>
<li><code>&lt;Leader&gt;cu</code> 把注释起止符剥掉，恢复原先的代码</li>
</ul>
<p>下面这些则只能工作于完整的一行或多行上：</p>
<ul>
<li><code>&lt;Leader&gt;c&lt;Space&gt;</code> 用来切换注释和非注释</li>
<li><code>&lt;Leader&gt;cb</code> 用来加上“美观”的注释</li>
<li><code>&lt;Leader&gt;cs</code> 用来加上“性感”的注释</li>
</ul>
<p>取决于具体的语言，行内注释、“美观”注释和“性感”注释不一定全部都适用（比如，在 Python 里就没有在一行内部开始加结束的注释）。我们拿支持所有这些情况的 C++ 代码来演示一下这些不同的注释类型：</p>
<p><img src="assets/503fb029feb4d00f511c5c270eccd4fd.gif" alt="Fig15.10" title="NERDCommenter 的多种不同注释类型" /></p>
<p>目前 NERDCommenter 支持的文件类型也有一百种左右了，应该说还是非常全面的。对于调试代码，它也是一个非常重要的工具。</p>
<h2>Visual-Multi</h2>
<p>我们今天要介绍的最后一个重要插件是 <a href="https://github.com/mg979/vim-visual-multi">Visual-Multi</a>，它允许你把“光标”同时放在多个不同的位置上，然后下面的命令对所有的位置都有效。利用这个插件，我们要做变量重命名之类的操作就会变得非常简单。</p>
<h3>安装和配置</h3>
<p>我们利用包管理器安装 mg979/vim-visual-multi 即可。这个插件的默认配置挺合理，我目前没有发现要修改的内容。</p>
<h3>使用</h3>
<p>这个插件的核心功能，是帮你选中多个不同的位置，然后我们就可以使用正常的编辑命令，包括 <code>c</code>、<code>d</code>、<code>i</code> 等，来进行编辑。</p>
<p>所以，下一个问题自然是，我们该如何选中多个不同的位置呢？</p>
<p>Visual-Multi 里还是提供了好几种不同的选择方式的（<code>:help vm-quickref</code>），我们就只讨论最常见的情况，根据搜索条件来进行选择。</p>
<p>在 Visual-Multi 里，特别的搜索命令是 <code>\\/</code>。跟普通的搜索命令一样，在输入的过程中我们即可看到屏幕上的匹配。但在搜索完成之后，<code>n</code> 命令不再仅仅意味着跳转到下一个匹配位置，而是选中当前的位置，并跳转到下一个匹配位置。如果想要跳过一个位置，则可以使用 <code>q</code> 命令。想要直接选中所有匹配的位置的话，可以使用 <code>\\A</code> 命令。</p>
<p>跟我们可以用 <code>*</code> 命令直接搜索光标下的单词一样，在 Visual-Multi 里我们也有一个快捷搜索命令 <code>&lt;C-N&gt;</code>。之后，我们的使用方式就一样了。下面，我就演示一下怎么用这个快捷搜索命令加其他的 Visual-Multi 命令来完成[第 10 讲]综合实验里的那个批量代码更名操作。</p>
<p><img src="assets/d8652f26606c4549e331c9b951faf079.gif" alt="Fig15.11" title="使用 Visual-Multi 来完成类型更名操作" /></p>
<p>看明白了吗？保险起见，我稍微解释一下吧。</p>
<ul>
<li>我首先使用 <code>&lt;C-N&gt;</code> 命令搜索 <code>\&lt;smart_ptr\&gt;</code>，开始了特殊的 Visual-Multi 模式，扩展模式（相当于可视模式）。</li>
<li>然后我使用了 <code>\\A</code> 命令选中所有的匹配位置。</li>
<li>由于文件名不应该更改，我使用 <code>q</code> 键跳过第一个匹配。</li>
<li>随后，我移动光标位置，缩小选中的位置。</li>
<li>之后，我就可以使用 <code>c</code> 命令直接输入需修改部分的新名字了。</li>
<li>最后，我按一次 <code>&lt;Esc&gt;</code> 退出插入模式，再按一次 <code>&lt;Esc&gt;</code> 退出 Visual-Multi 模式（从屏幕底部也可以看到文字提示）。</li>
</ul>
<p>Visual-Multi 也支持用 <code>\\\</code> 命令来手工增加一个光标位置，也有其他的一些命令和功能。这些，就请你自己慢慢摸索练习了。毕竟，它的帮助文件的篇幅就比我这整个一讲还多呢。</p>
<h2>内容小结</h2>
<p>今天我们介绍了五个非常重要的插件。其中，Fugitive 和 GitGutter 是用来支持 Git 版本管理的，Airline 是提供界面上的丰富信息提示的，NERDCommenter 和 Visual-Multi 则可以让一些代码的编辑任务变得更加高效。</p>
<p>本讲我们的配置文件中加入了这些不可或缺的插件，对应的标签是 <code>l15-unix</code> 和 <code>l15-windows</code>。</p>
<h2>课后练习</h2>
<p>高效地用好这些插件，可以让你的 Vim 使用效率再上一层楼。我们今天的课后练习，就主要是温习一下学到的知识了：</p>
<ol>
<li>安装好这些插件（应该每个都很有用）</li>
<li>打开 Git 管理下的我们的配置文件，体验一下 Airline 的显示效果</li>
<li>随便做点修改，并存盘，观察 GitGutter 和 Airline 对边栏和状态栏的提示变化</li>
<li>使用 <code>:Git</code> 命令打开 Fugitive 面板，在修改的文件上用 <code>=</code> 观察其中的修改</li>
<li>使用 <code>s</code> 把修改加到 Git 的暂存区，然后用 <code>cc</code> 签入修改</li>
<li>关闭 Fugitive 面板，回到 .vimrc 或 _vimrc 文件，用 <code>:0Gclog</code> 浏览文件的历史，并查看这个文件的历史状态</li>
<li>用 <code>1&lt;C-^&gt;</code> 命令或 <code>:e .vimrc</code> 之类的命令回到原始文件，然后用 <code>:Git blame</code> 命令查看文件每行的修改历史</li>
<li>如果光标在左侧窗口，使用 <code>gq</code> 命令，如果光标在右侧，使用 <code>&lt;C-W&gt;o</code> 命令，回到只有配置文件的状态</li>
<li>使用 NERDCommenter 的命令，如 <code>&lt;Leader&gt;cb</code>，来修改代码行的注释状态</li>
<li>使用 Visual-Multi，把代码中的 <code>source</code> 全部改成 <code>so</code></li>
</ol>
<p>最后，如果你不知道怎么回退刚才对 Git 库的修改的话，可以手工输入下面的 Git 命令：</p>
<pre><code>git reset HEAD~1
git reset --hard
</code></pre>
<p>在基本用法掌握之后，有学习余力的同学可以再仔细阅读一下帮助文件，了解我没有描述的用法。</p>
<p>如果有任何问题或疑问，欢迎留言和我讨论！</p>
</div>
                        </div>
                        <div>
                            <div style="float: left">
                                <a href="14%20Vim%20%E8%84%9A%E6%9C%AC%E7%AE%80%E4%BB%8B%EF%BC%9A%E5%BC%80%E5%A7%8B%E4%BD%A0%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AE%9A%E5%88%B6.md.html">上一页</a>
                            </div>
                            <div style="float: right">
                                <a href="16%20%E7%BB%88%E7%AB%AF%E5%92%8C%20GDB%20%E6%94%AF%E6%8C%81%EF%BC%9A%E4%B8%8D%E7%A6%BB%E5%BC%80%20Vim%20%E5%AE%8C%E6%88%90%E5%BC%80%E5%8F%91%E4%BB%BB%E5%8A%A1.md.html">下一页</a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="copyright"><p>© 2019 - 2023 <a href="../../cdn-cgi/l/email-protection.html#29454545101d1818191e694e44484045074a4644" target="_blank">Liangliang Lee</a>. Powered by <a href="https://vertx.io/" target="_blank">Vert.x</a> and <a href="https://github.com/kaiiiz/hexo-theme-book" target="_blank">hexo-theme-book</a>.</p></div>
        </div>

        <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
    </div>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/vb26e4fa9e5134444860be286fd8771851679335129114" integrity="sha512-M3hN/6cva/SjwrOtyXeUa5IuCT0sedyfT+jK/OV+s+D0RnzrTfwjwJHhd+wYfMm9HJSrZ1IKksOdddLuN6KOzw==" data-cf-beacon='{"rayId":"7af074d8ce82fa86","version":"2023.3.0","r":1,"token":"1f5d475227ce4f0089a7cff1ab17c0f5","si":100}' crossorigin="anonymous"></script>
</body>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NPSEEVD756"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-NPSEEVD756');
    var path = window.location.pathname
    var cookie = getCookie("lastPath");
    console.log(path)
    if (path.replace("/", "") === "") {
        if (cookie.replace("/", "") !== "") {
            console.log(cookie)
            document.getElementById("tip").innerHTML = "<a href='" + cookie + "'>跳转到上次进度</a>"
        }
    } else {
        setCookie("lastPath", path)
    }

    function setCookie(cname, cvalue) {
        var d = new Date();
        d.setTime(d.getTime() + (180 * 24 * 60 * 60 * 1000));
        var expires = "expires=" + d.toGMTString();
        document.cookie = cname + "=" + cvalue + "; " + expires + ";path = /";
    }

    function getCookie(cname) {
        var name = cname + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i].trim();
            if (c.indexOf(name) === 0) return c.substring(name.length, c.length);
        }
        return "";
    }

    hljs.initHighlightingOnLoad()

</script>

</html>
